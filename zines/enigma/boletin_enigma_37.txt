-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

 _____________________________________________________________________
|                                                                     |
|    =======   ==    ===   ===    ====     ==     ==       ===        |
|     =         ==    =     =    =    =     ==   ==         =         |
|     =         = =   =     =    =          = = = =        = =        |
|     xxxxx     x  x  x     x    xxxxxx     x  x  x       x   x       |
|     x         x   x x     x    x     x    x     x      xxxxxxx      |
|     x         x    xx     x    x     x    x     x     x       x     |
|    xxxxxxx   xxx    xx   xxx    xxxxx    xxx   xxx   xxx     xxx    |
|_____________________________________________________________________|

       Boletín del Taller de Criptografía de Arturo Quirantes
             http://www.ugr.es/~aquiran/cripto/cripto.htm

Número 37                       1 Noviembre 2005

========================================================================

        EDITORIAL Y MISCELÁNEA

        NUESTRA HISTORIA
        - Criptografía en las Américas

        TEMAS DE ACTUALIDAD
        - Criptografía cuántica I: teoría

        LIBERTAD VIGILADA:
        - La "jaula de los elefantes"

========================================================================

<><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
                        EDITORIAL Y MISCELÁNEA
<><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>

        Hace   una   semana   me  planteaba  seriamente  interrumpir  la
publicación  del  boletín  de  este mes por falta de material. Hace tres
días,  se  me  acumulaban  los  temas  encima  de la mesa. Si este es el
panorama  que  se les presenta a los editores de diarios y periódicos de
papel, me sorprende que lleguen a viejos.

        Durante  los últimos días me han llegado diversas noticias sobre
criptografía,  histórica y moderna. Algunas de ellas son breves, de modo
que  no justifican un artículo completo, pero vamos a mencionarlas aquí,
en este editorial reconvertido en cajón de sastre.

        En  primer  lugar,  he  ganado  una camiseta. Tiene una señal de
tráfico  donde  aparece  la  silueta  de  un  helicóptero  y el aviso de
"peligro, helicópteros negros" Es una referencia al mundo de las teorías
conspirativas,  donde  los  poderes  en  la  sombra  envían  hombres  (y
aeronaves)  de  negro  para  silenciar  a  los  que saben demasiado. Por
supuesto,  en  este  caso es una broma. Sucede que el diario electrónico
The  Register,  especialista en noticias sobre tecnología e ironía fina,
lanzó  un concurso para ver quién conseguía las tomas más espectaculares
de  Google  Earth.  Centenares  de concursantes escanearon el planeta en
busca de submarinos nucleares, bases de misiles ICBM y similares. Uno de
los ganadores fue este que firma, con una fotografía de parte de la base
de  Rota,  en  el suroeste de España. La sección en la que me fijé es la
esquina  noroeste,  donde  aparece  una  estructura  gigantesca  llamada
vulgarmente  "jaula  de  elefantes"  y  usada  por EEUU para interceptar
comunicaciones  por  radio.  Apareció, entre otras cosas, en el libro de
Nacho  García Mostazo "Libertad Vigilada" (Segunda parte, capítulo 4), y
quien no encuentre el libro puede leer ese capítulo en el Boletín Enigma
nº  21  (ver  también  el  artículo  al  final de este ejemplar). Lo más
extraño  del caso es que esa enorme antena, después de tomadas las fotos
por  satélite  de Google Earth, ha desaparecido. !Ya no existe! Misterio
misterioso,  aunque  a  mí  me  ha  hecho  ganar puntos y ser uno de los
ganadores  del concurso de The Register, cuyos resultados podéis ver en:
http://www.theregister.co.uk/2005/10/14/google_earth_competition_results/
y donde podréis pasar un rato entretenido.

        En  segundo  lugar,  podemos  hablar  de  Kasumi.  No,  no es un
conocido  común,  ni  el  último juego japonés de moda. Es el nombre del
algoritmo  usado  para  confidencialidad  e  integridad  en  los  nuevos
teléfonos  de  tercera  generación (3G). Apareció en este boletín el año
pasado  ("La seguridad de los teléfonos móviles", Boletín ENIGMA nº 22),
y  era  a  su  vez una reproducción de un Informe de 2001. De este nuevo
algoritmo,  apenas  conocido  entonces,  escribí: "la confidencialidad e
integridad  en el intervalo aéreo (entre el móvil y la estación base) es
tarea  reservada  al  algoritmo KASUMI. Traducible como "niebla", Kasumi
parece ser un algoritmo en bloque de 128 bits que tiene ciertos derechos
intelectuales.  La  ausencia  de  ataques  conocidos  hasta ahora contra
Kasumi  significa  una  de  dos  cosas:  o bien yo soy un manta buscando
información :-(, o bien no existen hasta la fecha. A falta de más datos,
quiero  pensar  que este algoritmo ha sido bien diseñado. Personalmente,
hubiese  preferido  un  algoritmo  más conocido y usado (por ejemplo, el
mismo  Rijndael),  pero  reconozco  que  me  baso  en los prejuicios. En
cualquier  caso,  es  bueno  que  el  algoritmo  Kasumi  haya sido hecho
público,  de  forma que la "seguridad mediante oscuridad" sea sustituida
por la alternativa "luz y taquígrafos" que tan buenos resultados ha dado
hasta ahora para separar el trigo de la paja."

        Bien,  pues  el  algoritmo  Kasumi está sufriendo los ataques de
diversos  criptoanalistas.  Tres  de  ellos  (Eli Biham, Orr Dunkelman y
Nathan   Keller)   acaban  de  publicar  un  artículo  titulado  "Ataque
rectangular de clave relacionada contra Kasumi". Como siempre, es uno de
esos  tipos de ataque complicados de entender, pero el lector con buenos
conocimientos   matemáticos,  y  mucho  tiempo  libre,  puede  probar  a
entenderlo en http://www.cs.technion.ac.il/users/wwwb/cgi-bin/tr-get.cgi
/2005/cs/cs-2005-14.pdf,  y  si  lo entiende que corra la voz. No parece
que  Kasumi  vaya  a  dar  con sus huesos en la basura por esto, pero de
nuevo  nos  queda  el mal sabor de boca que aparece cuando algo funciona
peor  de  lo que nos esperábamos. Curiosamente, el artículo comienza con
las palagras "Kasumi es un sistema de cifrado en bloque de 64 bits usado
en...",  pero  en  mi Boletín recuerdo haber escrito que tenía 128 bits.
¿Me  equivoqué,  o  alguien  ha  decidido  que  128  bits  son demasiada
seguridad  para  el  usuario nuevo? Habrá que averiguarlo, y rápido, que
los helicópteros negros ya deben de estar en el aire.

        En  tercer  lugar, un aviso de la empresa Microsoft. De repente,
alguien  allí  ha decidido que es mejor no usar el protocolo SSL versión
2,  así que la versión 7 del navegador Internet Explorer no lo admitirá.
Para  quien  no  lo  sepa, SSL (Secure Sockets Layer) es un protocolo de
comunicaciones seguras usado por los navegadores de Internet. La versión
2 usa criptografía bastante débil, con claves de cifrado de 40 bits, que
en la actualidad es lo mismo que nada. La versión 3 utiliza criptografía
más  fuerte (128 bits). Bien, si ustedes han sido buenos y han leído mis
Informes  1 y 4 (http://www.ugr.es/~aquiran/cripto/informes.htm) estarán
al  tanto  del  asunto,  a pesar de que los escribí hace casi ocho años.
Bien,  pues  los  "expertos"  en  seguridad  de  Microsoft parecen haber
descubierto  este  problema ahora. Enhorabuena, chicos, !solamente os ha
llevado  una  década!  A  lo  mejor  se  deciden  y acaban fabricando un
navegador  fiable  y  seguro de una vez, como el Firefox, que recomiendo
encarecidamente  a  mis  lectores.  Y  sí, soy de los que solamente usan
Internet Explorer a punta de pistola.

        En cuarto lugar, una necrológica. Hace poco murió el historiador
Guillermo  Lohmann  Villena.  Natural  de  Perú, pasó bastante tiempo en
España, estudiando la documentación del Archivo de Indias en Sevilla. Me
enteré  de  la noticia casualmente, leyendo una revista de historia hace
tan  sólo  un  par  de días. Y, aunque otro nombre me hubiera dejado más
frío,  el de Guillermo Lohmann me llamó la atención enseguida, ya que en
la  década  de  los años 50 publicó diversos estudios sobre los sistemas
criptográficos  usados  durante  la  conquista  española de América y la
emancipación posterior. Él la denominaba "criptografía indiana", y yo he
tenido  la  suerte  de leer sus magníficos trabajos por una copia que me
envió  José Ramón Soler (gracias neng, te debo una). Parece que su labor
investigadora  posterior  relegó  al  olvido sus trabajos pioneros sobre
criptografía,  pero  no  vamos a permitir que eso continúe. Este boletín
irá  transcribiendo  algunos  de  sus  trabajos  (no  todo, claro, o nos
quedaríamos  sin  bits),  que  espero serán de vuestro interés. Mientras
tanto,  en  este  ejemplar podréis leer el artículo "criptografía en las
Américas".  Proviene de mi archivo personal (de ese libro que acabaré de
escribir  un  milenio  de esos) y no está demasiado depurado, pero no he
querido  dejar  pasar  la  ocasión  de  rendir mi pequeño tributo a este
precursor  y mantener viva su memoria. Es una parte de la historia de la
criptografía  que  une  España  e  Iberoamérica,  así que espero que los
lectores  de ambas partes del mundo disfruten del artículo, enmarcado en
el apartado de "Nuestra Historia". Espero que les guste a todos.


<><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
                           NUESTRA HISTORIA
<><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>

=----------------------------------------------------------------------=
                     Criptografía en las Américas
=----------------------------------------------------------------------=

        Resulta  altamente  llamativo  que  ni  una  sola  de las Cifras
Generales expedidas en tiempos de Felipe II incluyese como destinatarios
a  funcionario  alguno  de  las  Américas.  Ninguna de las compilaciones
clásicas  de  cifras,  como  las de Carmona, Alcocer o Devos, menciona a
usuario  de  cifra  alguno  fuera  de  Europa. En parte, esto se explica
porque  dichas compilaciones se basan en cartas y cifras guardadas en el
Archivo General de Simancas, en tanto que los documentos relevantes a la
América  española han de buscarse en el Archivo General de Indias. Pero,
a  despecho  de peculiaridades archivísticas, resulta llamativo el hecho
de que las cifras destinadas a Europa y a las Indias se confeccionasen y
distribuyesen de forma separada.

        El  historiador  peruano Guillermo Lohmann Villena realizó en la
década  de  1950  un  estudio  de lo que él mismo denomino "criptografía
indiana." Al contrario que en Simancas (donde, por ejemplo, se guarda un
legajo entero solamente a cifras y claves), el Archivo General de Indias
almacena  multitud  de  cartas  cifradas  dispersas  en sus fondos, cuya
localización  es  a  menudo fruto de la buena estrella del investigador.
Los trabajos de Lohmann nos permiten conocer que en la América de Felipe
II  se  utilizaron diversas cifras, si bien en algunos no poseemos copia
ni siquiera descripción.

        La  primera  referencia a una cifra indiana en tiempos de Felipe
II  está ligada a la Casa de Contratación. Desde mediados del siglo XVI,
y   por   delegación   del   Consejo  de  las  Indias,  puso  en  marcha
procedimientos criptográficos para mantenerse en contacto con las flotas
que  navegaban a Indias; otros códigos mantenían al rey informado de las
últimas noticias procedentes del Nuevo Mundo. En las instrucciones a los
jefes  de  las  escuadras  se  consignaba  que dentro de los veinte días
siguientes a la llegada de la flota a América (San Juan de Ulúa para las
convoyes  de  Nueva  España,  Nombre  de  Dios para los de Tierra Firme)
despacharían  una carabela dando aviso de la llegada, novedades, y fecha
proyectada para el viaje de vuelta, así como monto de los tesoros que se
embarcarían.  Ello  se  transmitiría  cifrado en dos copias, una cursada
directamente a España y otra por vía La Habana.

        La  primera evidencia de una clave de la Casa de Contratación es
una  carta cifrada del Capitán General Pedro de las Roelas, desde Nombre
de  Dios,  al Presidente y Oficiales de la Casa de Contratación, fechada
el  4  de  mayo  1558. No se conoce dicha cifra, pero sí otras similares
usadas  en  fecha  cercana  por  otros  altos funcionarios: el Almirante
Antonio  de  Aguayo  (1563),  el  General  Velasco  de Barrio (1566), el
Almirante  Flores  de  Valdés  (1567),  el  Almirante Cristóbal de Eraso
(1568).   Todos   ellos  usaban  cifras  similares  y  sorprendentemente
sencillas,   ya  que  todas  ellas  consistían  en  meros  alfabetos  de
sustitución monoalfabética, sin homófonos.

        Que  en  el  siglo  del nomenclátor se confiasen los secretos de
Indias a cifras tan débiles es algo que sorprende. Lohman lo atribuye al
desconocimiento  del español por los eventuales intérpretes extranjeros.
Pero  los  criptoanalistas  italianos,  flamencos o ingleses no tuvieron
problemas  con  ello (como veremos más adelante, la propia Cifra General
de 1556 fue rota por los criptoanalistas papales en pocos meses).

        El estudio de las necesidades en seguridad de comunicaciones con
las  Indias  puede proporcionarnos una explicación más satisfactoria. Un
vistazo  al  mapa  europeo  de  la  época muestra la necesidad que tenía
Felipe  II  de  usar  la  cifra.  Flandes, Italia, el Sacro Imperio, las
embajadas  en  Francia  e  Inglaterra    todos  esos lugares bullían de
enemigos  deseosos  de  conseguir  noticias y capaces de interceptar los
correos  imperiales, cuyas rutas transcurrían por territorio hostil. Sin
embargo,  el  envío  de un mensaje dentro de las posesiones españolas en
América,  o  entre  éstas  y  España,  transcurría  en  terreno  propio.
Ciertamente  existía  el  riesgo  de apresamiento por parte de piratas o
corsarios,  especialmente  franceses,  holandeses  e ingleses, pero unos
asaltantes  de  barcos  en  busca  de  tesoros  no eran precisamente los
mejores criptoanalistas de la época.

        Por  otro  lado, el mar es un excelente medio para deshacerse de
la documentación secreta en caso de ataque. El navegante Pedro Sarmiento
de  Gamboa  refiere  que,  al  retornar  a España en agosto de 1586, fue
atacado  a  la  altura  de  las Azores por piratas ingleses. Aunque cayó
prisionero, tuvo la previsión de desprenderse previamente de buen número
de papeles que llevaba a bordo, reteniendo tan sólo los más importantes,
que  por  hallarse  en  cifra  se encontraban a salvo de los ojos de los
corsarios.

        Más bien parece que los sistemas de cifra, por rudimentarios que
fuesen,  estaban destinados a evitar la lectura de mensajes por parte de
otros españoles. Las rencillas entre los diversos funcionarios de Indias
eran  el  pan de cada día, y las taxativas prohibiciones en contra de la
apertura  no  autorizada  de  correspondencia  de  poco  valían  ante la
negligencia  de los funcionarios o los celos de los virreyes. Esto ayuda
a explicar la paradoja de que, aunque las cifras emitidas por la Casa de
Contratación   cayeron   pronto   en   desuso,  la  criptografía  siguió
extendiéndose en los dominios americanos cada vez más.

        En  algún  caso,  las  cifras  servían  para  establecer canales
seguros  de comunicación con los centros de poder en Madrid. Este era el
caso  del virrey Francisco de Toledo, quien hacia 1568 tenía en Madrid a
un  gestor  de  sus  asuntos, Pedro Castillo del Salto, con autorización
para emplear lenguaje cifrado en su correspondencia con el secretario de
Toledo,  Diego  López de Herrera. El propósito era mantener informado al
virrey  de  cuanto  fuese  de trascendencia política en la metrópoli, en
particular  sobre  el  curso de las negociaciones con la Santa Sede y la
evolución   de   las  campañas  emprendidas  contra  los  turcos  en  el
Mediterráneo.  No se tiene copia de la cifra, pero se sabe que una cifra
similar,  utilizada  entre  Toledo  y  el Fiscal de la Audiencia de Lima
Licenciado   Cristóbal   Ramírez   de   Cartagena,  era  de  sustitución
monoalfabética  simple,  sin homófonos. Por primera vez en el continente
americano,  se  incluyen  equivalencias para las letras dobles, llamadas
dúplices (ll, rr).

        Aunque la imposición de sistemas de cifra a flotas y armadas por
parte  de la Casa de Contratación estaba en desuso, las cifras adoptadas
en el Nuevo Mundo mantenían la misma forma de sustitución monoalfabética
simple.  Una  de  tales  cifras  fue  usada  de forma mancomunada por el
Gobernador  y  Capitán General de Cuba Juan de Tejada y el General de la
Flota  Pedro  Menéndez Márquez en su correspondencia con el Monarca, por
intermedio del Secretario del Consejo de las Indias, Juan de Ibarra.

        Las  cosas  eran  muy distintas en el siglo XIX. La corriente de
oposición  al  autoritarismo  de  Napoleón  en  Europa se trasladó a las
posesiones    americanas    de   España.   Durante   la   guerra   entre
independentistas  y  realistas,  ambos  bandos acudieron al cifrado para
proteger sus comunicaciones . En el año 1818, San Martín envió agentes a
Lima  con el fin de recabar información y enlazar con los partidarios de
su causa. Los agentes -José Fernández Paredes y José García- usaron tres
sistemas de cifra: "tintas simpáticas" basadas en nitrato de bismuto (lo
que más que cifra se debería considerar una forma de esteganografía), un
libro de código y un sistema de trasposición mediante clave de rejilla.

        Otros  sistemas, usados para las comunicaciones entre San Martín
y sus corresponsales, se basaban en alfabetos de sustitución simple, muy
parecidos a las cifras cesarianas. Uno de los empleados en 1810 por José
Boque es un ejemplo típico:

Texto llano:  A  B  C D E F G H I J L M  N  O  P  Q  R  S  T UV X  Z
Alfabeto 1:  12 11 10 9 8 7 6 5 4 3 2 1 23 22 21 20 19 18 17 16 15 14

        El  propio  San  Martín, en su correspondencia privada, usaba un
método  de  cifra  en  el que las letras A,B,C eran sustituidas por los
números 2,4,6 Es decir, la cifra privada de San Martín es tributaria de
la clave de César, casi dos mil años después.

        El  cifrado  se completaba con un conjunto de caracteres nulos y
con   una   representación  de  los  nombres  de  lugares  y  personajes
prominentes,  asemejándose así a los nomenclátores de siglos atrás. Así,
Bolívar   era   Rómulo,   San   Martín   era  Americano,  los  ejércitos
independentistas  eran  romanos  y las tropas españolas se convertían en
los  moscovitas. Según Germán Leguía, estos sistemas de cifra, sencillos
hasta   lo   indecible,   fueron   no   obstante   cruciales   para  los
independentistas,  quienes  pudieron  así  obtener  valiosos  informes y
transmitir las órdenes oportunas.

        También los fieles a la metrópoli (denominados realistas) usaron
sistemas de cifra, cuya simplicidad rivalizaba con la de los alzados. El
General Ricafort, en 1821, usaba la siguiente cifra monoalfabética:

Texto llano:    A B C D E G I J L LL M N O P Q R S T U V Y
Alfabeto:       o d g l q c t s r rr u z e n j h f b k y ñ

        José  de  la Serna, el último Virrey del Perú, empleó un sistema
de  trasposición  por  rejilla  simple.  Ambas  cifras  cayeron ante las
habilidades  de  Bernardo  de  Monteagudo, criptógrafo y criptoanalista.
Monteagudo   fue  el  autor  de  las  primeras  claves  usadas  para  la
correspondencia  de  las  misiones  peruanas  en  el  exterior,  y se le
considera el primer criptógrafo del Perú.


<><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
                          TEMAS DE ACTUALIDAD
<><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>

=----------------------------------------------------------------------=
                         Criptografía cuántica
=----------------------------------------------------------------------=

        Dice  un viejo aforismo político que, de tanto en tanto, hay que
cambiarlo  todo  para  que  nada cambie. En el campo de la criptografía,
nada  puede  ser  más  cierto.  Cada cierto tiempo aparece un sistema de
cifra  revolucionario  y  aparentemente indescifrable, el Grial que va a
resolver   de   una   vez  para  siempre  todos  nuestros  problemas  de
comunicación.  Felipe  II  tenía  sus  nomencladores,  Luis XIV su Cifra
Indescifrable,   los   alemanes  la  Enigma,  nosotros  la  criptografía
asimétrica. Bueno, pues resulta que tarde o temprano se descubren fallos
y  vulnerabilidades  que,  en  el  mejor de los casos nos obliga a tomar
precauciones  adicionales  (en  el peor, a tirar el sistema a la basura,
con  copia para el Museo), y en cualquier caso nos origina una crisis de
fe.  Si  después  de  la  guerra,  los  aliados les hubieran dicho a los
alemanes  que sabían descifrar sus códigos Enigma, seguro que no sabrían
si cortarse las venas o dejárselas largas.

       Tenemos  ahora un nuevo y revolucionario sistema de cifra llamado
criptografía  cuántica.  Al  contrario  que otros algoritmos, éste no se
basa en complicadas relaciones matemáticas, sino que se apoya en sutiles
propiedades  de la naturaleza. Se basa en la idea de que cualquier espía
puede  ser  detectado, de tal forma que podemos saber cuándo un canal de
comunicaciones  es  seguro.  Es como una caja fuerte que hace saltar una
alarma cada vez que alguien se atreve a tocarla.

        El  problema  es  que, para el común de los mortales, la palabra
"Física"   evoca  imágenes  de  un  mundo  incomprensible.  Los  físicos
supuestamente  son  personajes  extraños,  con  bata  blanca  y  cabello
revuelto, más chiflados que una regadera. Así que de la física cuántica,
mejor  ni  hablamos.  No  sólo  es más complicada que una declaración de
impuestos, sino que apenas se enseña en las escuelas. Sin embargo, vamos
a tener que meter los pies en esa piscina, así que síganme y vamos a ver
hasta dónde podemos llegar sin ahogarnos.

        El  mundo cuántico es uno de incertidumbres. Nunca podemos estar
seguros  de algo, sino que todos los cálculos involucran probabilidades.
Un  cuerpo no está aquí, sino que tiene un X% de probabilidades de estar
aquí.  Un  electrón  puede  estar en dos sitios distintos a la vez (y de
hecho,  podemos diseñar un experimento para que el electrón pase por dos
rendijas a la vez). Podemos calcular la posición de un cuerpo, y también
su  velocidad,  pero cuando mejor conozcamos uno de esos parámetros peor
podremos  determinar el otro. Es, en suma, un mundo nebuloso y oscuro. Y
por eso, puede resultar el lugar perfecto para ocultar información.

        Una  de  las  bases  de  la mecánica cuántica es el principio de
incertidumbre. Entre otras cosas, nos dice que es imposible realizar una
medición  sin  alterar el estado de lo que estamos midiendo. Imagínense,
por  ejemplo, una mesa de billar con bolas que van y vienen. Una persona
con  los ojos vendados podría intentar averiguar la posición y velocidad
de  una de las bolas, acercando las manos y tocándola. Pero en cuanto la
toque,  la  velocidad  de  la  bola  habrá  cambiado. Podemos diseñar el
experimento con toda la finura que queramos, usando incluso haces de luz
para detectar las bolas, pero el principio permanece: no importa lo bien
que lo hagamos, siempre que midamos algo estaremos alterando el valor de
éste algo.

        Vamos a ver cómo podemos utilizar dicho principio para construir
un  canal seguro de comunicación. Vamos a utilizar fotones polarizador y
medirlos  con  polarizadores.  Y,  antes de que la mitad de mis lectores
salga  corriendo,  tranquilos,  que  no  les  voy a dar una charla sobre
óptica.  Pueden  ayudarse  de  un  libro  de  física, si les resulta más
entretenido, pero realmente no lo va a necesitar. Limítense a creerse lo
siguiente:

        1) Una onda de luz puede polarizarse
        2)  Hay  aparatos llamados polarizadores que permiten o bloquean
el  paso de la luz.  Ello dependerá de la polarización de la luz y de la
forma en que pongamos el polarizador.

        Es  decir,  a  veces el polarizador deja pasar la luz, y a veces
no.  Es  como una rendija por la que tenemos que hacer pasar una moneda.
Si  la  rendija  está  horizontal y yo pongo la moneda en horizontal, la
moneda  pasa.  Si  la  moneda  está  vertical, u oblicua, no pasa. Quizá
hubiera  tenido  que  usar  esta analogía desde el primer momento, y nos
hubiéramos  complicado  menos  la existencia. En cualquier caso, sigamos
adelante.

        Vamos   a  usar  fotones,  esto  es,  paquetes  individuales  (e
indivisibles)  de  luz.  Cada fotón estará polarizado, y vamos a suponer
que  solamente  hay  cuatro  direcciones  de  polarización:  horizontal,
vertical  y  las  dos diagonales. Es decir, nuestras "monedas fotónicas"
solamente podrán estar en estas cuatro posiciones : - / | \

        En  segundo  lugar,  vamos a traer nuestros polarizadores. Serán
las  rendijas  por  las que haremos pasar nuestras monedas. Vamos a usar
dos  polarizadores:  el  recto (u horizontal/vertical) y el oblicuo, que
denotaremos  como  +  y  X, respectivamente. En el mundo clásico, cuando
pasamos  un haz de luz por su polarizador correspondiente, no pasa nada.
En  este  caso,  la  luz  con  polarización  -  o | pasaría a través del
polarizador  +  sin  alterarse.  ¿Y  si  el polarizador fuera el X? Pues
pasaría  luz,  pero  solamente  la  mitad,  y  se convertiría en luz con
polarización / y \.

        En  el  caso  cuántico, esto cambia un poco. El motivo es que no
puede  pasar solamente medio fotón, ya que el fotón no es divisible. Así
que lo que pasa es lo siguiente. Supongamos un fotón con polarización -.
Si  pasa  por  un polarizador +, no le pasa nada. Pero si se topa con un
polarizador X pueden pasar tres cosas. O no pasa, o su polarización pasa
a  /,  o  pasa  a \. Cuál de las tres cosas pasen es algo que no podemos
controlar, porque es inherente a la naturaleza de la mecánica cuántica.

        ¿Qué  les parece si nos ponemos ya manos a la obra? Ya está bien
de tanta zarandaja física y matemática. !A encriptar, que es lo nuestro!
Lo  que  vamos  a hacer es suponer dos interlocutores (Alicia y Benito),
una  espía  (Eva)  y  una tarea: intercambiar una clave de cifrado entre
Alicia  y  Benito  sin  que  Eva  se  entere.  Por  supuesto,  podríamos
intercambiar  el  mensaje directamente, pero resulta mucho más eficiente
enviar  la  clave de un sistema de cifra simétrico (AES, TripeDES, IDEA,
etc).

        Vamos a suponer que Alicia desea enviar la clave en la forma del
código  binario.  Lo  primero que tenemos que decir es cómo codificar la
información.  Pues bien, digamos que el bit 0 corresponde a un fotón con
polarización  |  o  /, y el 1 es un fotón - o \. Como veréis, hay muchas
combinaciones  de  fotones  posibles. Por ejemplo, el número 1101 podría
estar  representado  por  los  fotones ---|, --\|, \-\| podemos elegir a
nuestro  antojo.  Así que Eva pone sus polarizadores y envía los fotones
correspondientes  a  la  secuencia que quiera enviar. Digamos que quiere
enviar  el  mensaje  001010111, y para ello envía los fotones: /|\|\/\\-
(y,  repito,  hay  muchas formas de hacerlo: el que Alicia haya escogido
para el primer 0 el fotón / y no el | es porque le dio la santa gana).

        A continuación, Benito recibe los fotones. Y aquí entra la magia
de  la  mecánica  cuántica.  Él  no  sabe  cómo son los fotones que va a
recibir,  de  forma que no tiene manera de saber qué polarizadores tiene
que usar para detectarlos. Lo que hace es escogerlos al azar. Tendríamos
así la siguiente secuencia:

        Mensaje de Alicia:              0 0 1 0 1 0 1 1 1
        Fotones enviados:               / | \ | \ / \ \ -
        Polarizadores de Benito:        + + + + X + + X +

        ¿Y qué es lo que observa Benito? Pues dependerá de la caprichosa
naturaleza  de  la  mecánica  cuántica. Por ejemplo, el primer fotón (/)
llega  al  primer  polarizador  (+).  Como dije antes, pueden pasar tres
cosas:  que  pase un fotón con polarización -, que pase con polarización
|,  o  que no pase en absoluto. Para simplificar, vamos a suponer que en
nuestro  ejemplo los fotones siempre pasan (en un caso real, si el fotón
no  pasa sencillamente lo ignoramos). Nuestra amiga la Mecánica Cuántica
tira su moneda al aire ... y sale polarización \, es decir, un bit 1. En
el  segundo  fotón,  la  cosa  es  más  sencilla:  un fotón | llega a un
polarizador  +, uno "de los suyos", así que pasa tal cual y Benito anota
un  fotón  |,  correspondiente  a  un  bit  0.  Tercer  caso;  fotón  \,
polarizador  +,  tiramos la moneda cuántica al aire, y sale polarización
\, o sea, un bit 1. De esa forma, vamos obteniendo la siguiente tabla:

        Mensaje de Alicia:              0 0 1 0 1 0 1 1 1
        Fotones enviados por Alicia:    / | \ | \ / \ \ -
        Polarizadores de Benito:        + + + + X + + X +
        Fotones recibidos por Benito:   \ | \ | \ / / \ -
        Mensaje recibido por Benito:    1 0 1 0 1 0 0 1 1

        !Y  el  mensaje  que recibe Benito se parece al que envió Alicia
como un huevo a una castaña! !Menudo timo! Pero claro, usted ya se habrá
imaginado  que  si  hemos  montado tamaño lío debe ser para obtener algo
mejor  que eso. Y efectivamente, así será, pero un poquito de paciencia,
porque  no hemos terminado. Lo siguiente que hace Bob es llamar a Alicia
mediante  un  canal  de  comunicación  no  seguro,  y  le  comunica  qué
polarizadores ha empleado. Alicia los compara con los suyos y le dice en
qué  ocasiones  ha  escogido  bien. Por ejemplo, el primer fotón era del
tipo  /,  así que Benito debería haber usado un polarizador X, pero como
no  lo  sabía  escogió  un  +. El segundo fotón era del tipo |, y Benito
escogió  correctamente el polarizador +. Así, Benito descarta algunos de
los  bits,  y  se  queda los bits restantes como clave. Asimismo, Alicia
toma  nota  de  qué  fotones  hay que descartar (los que se midieron con
polarizadores  incorrectos), y se queda los restantes. Tendríamos así la
siguiente información:

        Mensaje de Alicia:              0 0 1 0 1 0 1 1 1
        Fotones enviados por Alicia:    / | \ | \ / \ \ -
        Polarizadores de Benito:        + + + + X + + X +
        Fotones recibidos por Benito:   \ | \ | \ / / \ -
        Mensaje recibido por Benito:    1 0 1 0 1 0 0 1 1
        Polarizadores correctos (*):      *   * *     * *
        Clave intercambiada:              0   0 1     1 1

        De  esa  forma,  tanto  Alicia como Benito han intercambiado una
clave:  00111.  Y ahora, veamos por qué vale la pena complicarse la vida
de esa forma. En principio, la espía Eva, agazapada en algún lugar de la
línea  de  transmisión,  también  sabe  qué  polarizadores debería haber
usado.  De  esa  forma,  sabe  que  los  polarizadores correctos son los
(+,+,X,X,+)  colocados  en  los  bits  segundo, cuarto, quinto, octavo y
noveno, respectivamente. De forma que no tiene más que coger los fotones
y  ...  !no  puede  hacerlo!  ¿Por  qué?  Pues porque los fotones ya han
pasado.   El   conocimiento   de  los  polarizadores  correctos  es  una
información  que  habría servido a Eva antes de enviar los fotones. Pero
un fotón no puede ser almacenado para luego medir su polarización. En el
caso  de  un  haz  de  luz podría hacerse, pero incluso para almacenarlo
antes hay que medirlo.

        Eso  significa  que  Eva  se  ve  limitada  a intentar captar la
polarización  de  los  fotones al azar. Es decir, se ve obligada a hacer
como  Benito,  esto es, escoger polarizadores al azar y ver qué pasa. En
algunos casos acertará, y en otros no. Digamos que escoge el polarizador
correcto  en el segundo bit, y luego Alicia lo confirma. Eva ya tiene un
bit  de  la  clave.  Pero  en  otro caso, puede no tener suerte, y si la
probabilidad de acertar con un bit de la clave es del 50%, la de acertar
n bits será una entre 2^n. En nuestro ejemplo, imaginemos que Eva escoge
al  azar  los  polarizadores  +XX++X+X+. Vamos a ver qué obtendría:

        Fotones enviados por Alicia:    / | \ | \ / \ \ -
        Polarizadores de Eva:           + X X + + X + X +
        Fotones capturados por Eva:     \ \ \ | / / | \ -
        Bits capturados por Eva:        1 0 1 0 0 0 0 1 1
        Clave capturada por Eva:          1   0 0     1 1

        Polarizadores de Benito:        + + + + X + + X +
        Clave intercambiada:              0   0 1     1 1

        Véase  el  lector  cómo  cuatro  de los polarizadores de Eva son
diferentes  a  los  de Benito. De ellos, dos ayudan a formar la clave, y
eso  hace  que  la  clave  capturada  por  Eva (10011) sea distinta a la
intercambiada  por  Alicia  y  Benito (00111). Poco importa que Alicia y
Benito no hayan usado los mismos polarizadores, porque los que coincidan
le  servirá precisamente para construir la clave. Y poco importa que Eva
sepa qué polarizadores son los correctos, porque la información le lleva
demasiado tarde.

        Pero  lo  bueno  consiste  en que podemos detectar a Eva. En los
esquemas  tradicionales,  siempre  se supone que Eva puede meterse en el
canal  de  comunicación. En tal caso captará la información que pasa por
él.  Si  se  trata  de  un  canal seguro (mensajes cifrados) recibirá un
batiburrillo sin sentido, y si es un canal abierto podrá entender lo que
capta.  Aquí  hemos  supuesto canales de comunicación abiertos, de forma
que  Eva puede captarlo todo. Pero al contrario que en otros casos, aquí
la  información  pasa  fotón  a  fotón,  y el hecho de que Eva mida esos
fotones  cambia  el  estado de éstos. Es decir, el mero hecho de que Eva
esté  espiando  significa  que  los  fotones que envía Alicia no son los
mismos  que  los  que  recibe  Benito.  De hecho, la clave que construye
Benito es la misma que la que obtiene Eva. Véase:

        Mensaje de Alicia:              0 0 1 0 1 0 1 1 1
        Fotones enviados por Alicia:    / | \ | \ / \ \ -
        Polarizadores de Eva:           + X X + + X + X +
        Fotones capturados por Eva:     \ \ \ | / / | \ -
        Fotones recibidos por Benito:   \ \ \ | / / | \ -
        Polarizadores de Benito:        + + + + X + + X +
        Fotones recibidos por Benito:   \ - \ | / - | \ -
        Mensaje recibido por Benito:    1 1 1 0 0 1 0 1 1
        Clave recibida por Benito:        1   0 0     1 1

        De  forma  que  las  claves  que  tienen Alicia (00111) y Benito
(10011)  son diferentes, así que ningún mensaje cifrado por uno de ellos
podrá ser leído por el otro. ¿Qué concluyen Alicia y Benito? Pues que la
clave  (o  en  general, el mensaje) ha sido alterado. Esto puede suceder
por  los  tejemanejes  de la fisgona de Eva, o simplemente por problemas
durante  la transmisión (no olvidemos que en el mundo real, los mensajes
pueden    ser   alterados   por   las   condiciones   ambientales,   las
interferencias,  errores  de todo tipo, etc).

        Cualquiera que sea el caso, Alicia y Benito pueden establecer un
método   de   corrección   de  errores.  Puede  ser  tan  sencillo  como
intercambiarse  parte  de  la  clave  por  un  canal  abierto,  y ver si
coinciden. Digamos que tenemos una clave intercambiada de 200 bits. Para
asegurarse  de  que es la misma, se comunican el uno al otro uno de cada
10  bits.  Si  los  20 bits coinciden, no hay alteración (o bien la hay,
pero  con  una probabilidad de 1 entre 2^20) y todo va bien; si no es el
caso,  se  tira la clave a la basura y proceden a repetir el intercambio
de claves.

        Resumiendo: la criptografía cuántica permite intercambiar claves
de  cifrado  (o,  si  somos  lo  bastante burros, mensajes completos) en
canales  de  comunicación  abiertos, de tal forma que nadie pueda espiar
sin  ser  detectado.  Esto  se  consigue aprovechando las propiedades de
indeterminación inherentes al mundo cuántico.

        Todo  esto  es  la teoría, pero ¿cómo funciona en el mundo real?
¿Qué  empresas o entidades la usan? ¿Qué limitaciones o vulnerabilidades
prácticas  tienen?  Como ya nos hemos extendido mucho, lo dejaremos para
el  próximo  número.  De  momento,  se acabó la clase. Pueden levantarse
ahora  de  la silla y tomar una cerveza fresquita, que se la han ganado.
Pero  recuerden  que, mecanocuánticamente hablando, hay una probabilidad
pequeña pero finita de que la botella haya salido sola del refrigerador.
Claro  que  es  algo  muy  improbable, y a lo mejor fue Eva en la última
visita que le hizo a su cocina, pero nunca se sabe...


<><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
                           LIBERTAD VIGILADA
<><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>

=----------------------------------------------------------------------=
                      La "jaula de los elefantes"
=----------------------------------------------------------------------=

[Extraído  del  libro  "Libertad Vigilada", de Nacho García Mostazo, con
permiso del autor]

Primera parte, capítulo 7:

        La  mayoría de las estaciones que hemos mencionado se destinaron
desde  el  principio  a interceptar las comunicaciones por radio de alta
frecuencia  con  grandes  antenas.  Estados  Unidos  y  el  Reino  Unido
dominaban esta técnica desde antes de la Primera Guerra Mundial, pero la
tecnología evoluciona y el operativo mejoró notablemente su capacidad de
espionaje.  De ahí que en los años 60 comenzara la instalación de nuevos
y  espectaculares modelos de antenas en las bases Sigint y Comint de los
Aliados,  aunque  sin  duda  las norteamericanas son las más llamativas,
porque  cada  una  de ellas se compone de una circunferencia de unos 200
metros  de diámetro hecha de malla metálica. Su nombre en clave es "Iron
Horse"  ("Caballo de Hierro"), pero su denominación técnica es AN/FLR-9,
si  fueron  instaladas por la Fuerza Aérea, y AN/FLR-13, si son operadas
por  la  Marina, como asegura Duncan Camlbell. Sin embargo, dentro de la
comunidad   de   inteligencia  son  conocidas  como  "la  jaula  de  los
elefantes",  por su enorme tamaño. La primera estuvo operativa en 1964 y
aún  hoy,  en  la  era  de  las  comunicaciones  digitales,  prestan  un
importante servicio a las agencias Sigint. [1]

        La  Armada  y la Fuerza Aérea norteamericanas instalaron antenas
de este tipo en los Estados de Alaska, que cuenta con varias estaciones,
California,  Florida  y Maine, por mencionar algunas de las que están en
su  propio  territorio,  así  como en la base de Sabana Seca, situada en
Puerto  Rico. Asimismo, fuera de Estados Unidos también montaron antenas
en  Chiksands  (Inglaterra),  San Vito dei Normanni (Italia), Karamursel
(Turquía),   Filipinas,   Misawa  (Japón),  Rota  (España),  Bremerhaven
(Alemania),  Ezdell  (Escocia),  Guam  (en el Pacífico), el archipiélago
portugués de Azores, Panamá, Islandia, etc. La página en Internet de los
veteranos  del  Grupo  de  Seguridad Naval de Estados Unidos (NAVSECGRU)
muestra  fotografías  tomadas por sus soldados en los cinco continentes,
de las que incluso llegaron a hacer postales en algunos casos. Tanto las
fotos,  como  los  testimonios  de  los  propios  veteranos, son pruebas
elocuentes  de  la amplia cobertura de las operaciones de interceptación
llevadas a cabo por Estados Unidos. [2]

        Excepto  en  casos  muy  contados  de conexiones por cable entre
países  geográficamente  contiguos, la radio de alta frecuencia (HF) era
el  sistema  de comunicaciones internacionales más común, al menos antes
de  1970,  cuando  se  lanzaron los primeros satélites. Las emisiones HF
eran  utilizadas  por  las  empresas  públicas y privadas de telefonía y
telégrafos,  así como para transmisiones gubernamentales, diplomáticas y
militares.  Como  ya  se  ha  mencionado,  una  de  las  características
fundamentales  de  la  radio  de  alta  frecuencia  es  que sus ondas se
reflejan  en  la  ionosfera  y en la superficie terrestre, con lo que su
alcance  es  de  miles  de kilómetros. Por tanto, para interceptar estas
ondas  basta con tener un terreno adecuado e instalar en el mismo una de
esas  grandes  antenas.  Según  Duncan  Campbell,  las  "jaulas  de  los
elefantes"  pueden "interceptar simultáneamente y determinar la posición
de  señales  procedentes  de  tantas direcciones y en tantas frecuencias
como  se  desee".  Así, cuando dos de estas antenas interceptan la misma
comunicación  y  se  intercambian  los datos, un simple cálculo sobre un
mapa  permite  saber  desde  dónde  se ha hecho la transmisión, ubicando
exactamente  la  posición  de  los  centros emisores del "enemigo". Esta
técnica  se  denomina  radiogoniometría  y,  aunque  parezca trivial, su
aplicación tenía un alto interés estratégico, ya que hubiera permitido a
norteamericanos  y  británicos  bombardear  los  puestos de comunicación
soviéticos si de la Guerra Fría se hubiera pasado a un conflicto armado.
[3]

        Estas   grandes   antenas   aún   continúan   utilizándose  para
interceptar  las  comunicaciones  militares,  diplomáticas  y  civiles a
través  de operadores internacionales de redes arrendadas (International
Leased  Carrier,  ILC). Desde los primeros años del siglo XX, la mayoría
de los enlaces internacionales de telecomunicaciones han sido explotados
por  diferentes operadores, que suelen ser las administraciones públicas
nacionales  y  empresas  privadas  de  comunicaciones.  Duncan  Campbell
explicó  ante  el  Parlamento Europeo que un reportaje del Canal 4 de la
televisión  británica  emitido en 1993 había desvelado que "en agosto de
1966,  la NSA trasladó su sección de interceptación de ILC desde su base
escocesa de Kirkkewton a Menwith Hill, en Inglaterra. Diez años después,
esta  sección  volvió  a  trasladarse, esta vez a Chicksands, también en
Inglaterra.  Aunque la principal función de la base de Chicksands era la
interceptación  de las comunicaciones de las Fuerzas Aéreas soviéticas y
del  Pacto  de  Varsovoa,  tamibén  se  encargó de interceptar ILS y NCD
(comunicaciones  diplomáticas no estadounidenses). La mayor parte de las
presonas  que  trabajaban  en  Chicksands  eran  miembros de las Fuerzas
Aéreas   estadounidenses,   pero  la  interceptación  de  comunicaciones
diplomáticas  y  de ILC eran gestionadas por empleados civiles de la NSA
en una unidad denominada DODJOCC. [4]

        El  estado  de  paranoia  que  afectó  a los contendientes de la
Guerra  Fría  hizo  que,  como  acabamos  de  ver,  además de espiar las
comunicaciones   del   "enemigo"   también   escucharan  las  de  países
supuestamente  "amigos".  Hay pruebas que demuestran cómo Estados Unidos
interceptó  desde Chicksands comunicaciones diplomáticas frandesas (FRD)
e  italianas  (ITD).  Pero  también el Reino Unido lo hizo: "Durante los
años  70,  unidades Comint británicas emplazadas en Chipre recibieron el
encargo  de  interceptar las comunicaciones de alta frecuencia de países
aliados  de  la  OTAN,  Grecia y Turquía incluidas. La misión se realizó
desde  una  unidad  del Ejército británico ubicada en Agios Nikolaos, en
Chipre  oriental",  según Duncan Campbell. Pero este investigador va aún
más lejos al subrayar que Estados Unidos llegó a e espiar a su principal
aliado.  En  1975,  un  informe  sobre operaciones secretas del Gobierno
presentado  ante un Comité del Congreso de Estados Unidos reveló "que la
NSA  estaba  interceptando mensajes diplomáticos con origen y destino en
Washington  desde  una  base  militar  Comint situada en Vint Hill Farms
(Virginia).  Entre  los  objetivos  de  esta base se encontraba el Reino
Unido". [5]


        [1]. Duncan Campbell, "Interception Capabilities 2000". Op. cit.

        [2].  Página en Internet de los Veteranos del Grupo de Seguridad
Naval. Op. cit.

        [3]. Duncan Campbell, "Interception Capabilities 2000". Op. cit.
NOTA:  Las  siglas  DODJOCC  significan  "Department  of  Defense  Joint
Operations  Centre  Chicksands"  (Centro  Conjunto  de  Operaciones  del
Departamento de Defensa en Chicksands).

        [5].   "Informe   Fink"   ante  el  Comité  del  Congreso  sobre
Operaciones del Gobierno, 1975. Citado en el reportaje "NSA spies on the
British government", publicado en la revista británica New Statesman, el
25  de julio de 1980. Citado a su vez por Duncan Campbell, "Interception
Capabilities 2000". Op. cit.


========================================================================

El   boletín   ENIGMA   es   una  publicación  gratuita  del  Taller  de
Criptografía.  Se permite su reproducción y difusión sin ánimo de lucro,
citando nombre y referencia.

Para  darse  de  alta,  envíe  un  mensaje a la dirección aquiran arroba
ugr.es añadiendo las palabras alta_enigma en el asunto (subject).

Para  darse  de  baja,  envíe  un  mensaje a la dirección aquiran arroba
ugr.es añadiendo las palabras baja_enigma en el asunto (subject)

Para   consultas   o   comentarios  a  este  boletín,  se  ruega  añadir
noticias_enigma el comienzo del asunto (subject). Si desea colaborar con
el  Boletín  Enigma,  no  dude  en  ponerse  en  contacto  con el editor
añadiendo colaboración_enigma al asunto (subject).

Página del Boletín Enigma (incluyendo números atrasados):
http://www.ugr.es/~aquiran/cripto/enigma.htm


(c) Arturo Quirantes 2005

========================================================================

- ---------------------------------------------
Salu2.  Arturo Quirantes (PGP key 0x4E2031EC)
- ---------------------------------------------
_____________________________________________________

Manifiesto 12 de Octubre: no a la LSSI
http://www.ugr.es/~aquiran/cripto/tc-lssi/lssi_12o.htm
______________________________________________________

-----BEGIN PGP SIGNATURE-----
Version: PGP 6.5i

iQA/AwUBQ2aBa9Pjg85OIDHsEQK8kgCg2C/ftR0kqWPZ/uJQC+khgKc+54MAoKSd
iI2T5AYlqGHmd21dYmXKwkO0
=Scef
-----END PGP SIGNATURE-----



