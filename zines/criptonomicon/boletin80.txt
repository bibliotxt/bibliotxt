-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Boletín del Criptonomicón
http://www.iec.csic.es/criptonomicon
Año III, nº 80
19 de enero de 2001

******************************************
Susurros desde la Cripta
  1. Espías en el trabajo

Las noticias de la semana
  2. ¿Puñalada mortal a SSL?
  3. ¿Es ActiveX seguro?
  4. Campaña free-PKI 2001 de CriptoLab
  5. Uno de cada cinco empresarios espía a sus trabajadores
  6. La industria tecnológica se rearma contra el 'hacker'
  7. Guninsky vuelve a la carga
  8. La noticia de HispaSec: versión "segura" de Linux

Candados, cortafríos y otras herramientas
  9. Las tripas de Windows

Parada y fonda
  10. DatumLex

Consejos y trucos
  11. Conexiones fiables a BD

Hablan los expertos
  12. Ineficacia de la ley ante los virus informáticos

Virus y otros bichos
  13. Los últimos virus

Formación
  14. Convocatoria de beca para tesis doctoral en Criptografía

Sobre el boletín del Criptonomicón
  15. Información sobre suscripción y cómo borrarse
  16. Números atrasados
  17. Firma PGP

******************************************
Susurros desde la cripta

******************************************
1. Espías en el trabajo

Decía Mark Twain que existen tres tipos de mentiras: mentiras,
malditas mentiras y estadísticas. Sin creer ciegamente en los bailes
de números, lo cierto es que nos indican con claridad que desde que
las nuevas tecnologías se están popularizando y penetrando cada vez
más en las empresas y administraciones, se crean nuevas formas de
distracción para los empleados.

Según las últimas estadísticas, del 30 a 40% del tráfico de las
empresas no está relacionado con el trabajo (www.idc.com), en el
horario laboral tiene lugar el 70% de las visitas a los sitios
pornográficos (www.sextracker.com) y más del 60% de las compras en
línea, subastas y juegos de azar (www.websense.com). En definitiva,
pornografía, subastas, búsqueda de nuevo empleo, comercio
electrónico, banca a distancia, prensa, juegos, correos personales...
Las posibilidades son infinitas, como los contenidos de Internet. Ese
empleado que parece encontrarse tan atareado delante de la pantalla,
podría estar ocupándose en cualquiera de estos pasatiempos y el jefe
ni enterarse.

En el mejor de los casos, estas distracciones sólo le hacen perder
horas de trabajo y, por tanto, dinero al empresario. En el peor, sus
actividades podrían abrir agujeros de seguridad en la red corporativa
como consecuencia de la infección con algún virus o por permitir a
hackers colarse a través de su ordenador aprovechando algún fallo en
la configuración de sus programas o algún bug de su software: del
navegador, del cliente de chat, del correo electrónico, de Gnutella,
etc. También podrían crear problemas legales a la empresa si utilizan
sus recursos para compartir archivos ilegales, por ejemplo con
Napster, o enviar a las news fotos de pornografía infantil o
panegíricos terroristas con el correo de la empresa (por lo tanto,
viéndose en el campo del remitente de qué empresa se trata).

Estas posibilidades han alarmado a ciertos círculos directivos, que
han optado por vigilar la actividad laboral de los trabajadores.
Evidentemente, el legítimo derecho del empresario a que se haga un
uso eficiente de sus recursos informáticos y del tiempo por el que
paga a sus empleados, previniendo actividades inapropiadas, no
profesionales o incluso ilegales, entra en flagrante conflicto con el
inalienable derecho del trabajador a preservar su intimidad. Dado que
la jurisprudencia en esta materia es prácticamente inexistente,
muchos empresarios aprovechan las lagunas legales y optan por vigilar
el correo y navegación de sus empleados.

Echando mano nuevamente de las estadísticas, según una reciente
encuesta de KPMG (www.kpmg.com), publicada este martes, uno de cada
cinco empresarios espía el correo de sus empleados y su uso de
Internet, práctica que conduce en muchos casos al despido cuando se
descubre un mal uso, como visualización de pornografía (despido en el
55% de los casos) o correos ofensivos o difamatorios (despido en el
20% de los casos). Vault.com (www.vault.com), por su parte, señala
que el 31% de las empresas controla o restringe el uso de Internet y
del correo electrónico de sus empleados, datos no excesivamente
alejados de los de KPMG, llegándose en muchos casos también al
despido.

Para las empresas determinadas a saber qué hacen sus empleados con la
conexión de Internet, existe una amplia oferta de productos
comerciales para controlar, registrar y analizar el uso de los
recursos de la red empresarial, especialmente del correo y de la Web.
Su misión es ayudar a la empresa a reducir pérdidas de productividad,
proteger el ancho de banda, evitarle responsabilidades legales y
minimizar problemas de seguridad en general. Algunos de los productos
más conocidos del mercado son:

- - SurfControl (www.surfcontrol.com), para la gestión responsable del
uso de Internet en el hogar, en la escuela o en el trabajo.
- - Stealth Activity Recorder & Reporter ("STARR") (www.iopus.com),
para saber lo que un usuario de cualquier ordenador de la red está
haciendo en un momento dado en su máquina.
- - spIE (www.satacoy.com/spie/main.htm), que integrado con Internet
Explorer, permite monitorizar y restringir el uso del navegador.
- - TrafficMax (www.intellimax.com), para la monitorización proactiva
de tráfico de redes y de Internet, incluyendo el bloqueo de
direcciones e informes de actividad.
- - Websense (www.websense.com), el producto estrella de gestión,
monitorización y generación de informes sobre el uso de Internet en
el trabajo.
- - El Espía (www.el-espia.com), producto español para controlar de
forma sigilosa lo que los usuarios hacen en el ordenador.

Estos programas violan seriamente la intimidad de los empleados,
especialmente cuando el trabajador no ha sido informado de que su
labor está siendo vigilada. En las últimas semanas se está armando un
gran revuelo acerca del derecho o no del empresario a espiar a sus
trabajadores. La nueva legislación en vigor en Reino Unido, que
legitimaría al empresario a intervenir las comunicaciones de sus
empleados, así como el reciente despido de un empleado del Deutsche
Bank, que enviaba correo privado desde el trabajo, han venido a poner
el dedo en la llaga de una herida que, por otro lado, hace ya tiempo
que sangraba.

En terreno tan pantanoso, la transparencia abre la única vía ética a
seguir. La dirección debería informar, a la hora de firmarse el
contrato, de las prácticas de seguridad seguidas: si se intervienen
los correos electrónicos, si se monitoriza el uso de Internet, etc.
Las cosas claras, el trabajador sabe entonces a qué atenerse. Si bien
es verdad que el empleado tiene derecho a la intimidad, tiene también
la obligación de aprovechar el tiempo de trabajo por el que se le
paga. Del mismo modo, el empresario tiene derecho a que sus recursos
se utilicen únicamente para provecho de la empresa, así como la
obligación de preservar la intimidad de sus empleados. Mientras
tanto, no duden que veremos aumentar el uso de estos programas espía.

Opina sobre este tema. Envía tus comentarios a
criptonomicon@iec.csic.es.

Otros editoriales en:
http://www.iec.csic.es/criptonomicon/susurros

******************************************
Las noticias de la semana

******************************************
2. ¿Puñalada mortal a SSL?

El programa dsniff creado por Dug Song permite explotar las
debilidades de un protocolo tan extendido hoy en día como es SSL para
las operaciones de pago seguro a través de Internet, haciendo
posibles ataques de hombre en el medio. Como consecuencia, el cliente
no tiene garantía de si se ha conectado al servidor seguro del
comerciante o a un impostor, a pesar de los certificados y los
candados cerrados.

Más información:
http://www.securityportal.com/cover/coverstory20001218.html
http://www.monkey.org/~dugsong/dsniff/

Sobre SSL:
http://www.iec.csic.es/criptonomicon/comercio/ssl.html

******************************************
3. ¿Es ActiveX seguro?

ActiveX permite incrustar programas plenamente funcionales dentro de
las páginas Web, haciéndolas mucho más dinámicas e interactivas. Sin
embargo, introduce serios problemas de seguridad, ya que una vez
cargados en nuestro ordenador, si el usuario los acepta, se ejecutan
con control total sobre nuestros recursos, pudiendo perpetrar
cualquier tipo de fechoría, desde destruir datos hasta inocular
virus. El CERT ha publicado recientemente un informe sobre la
tecnología ActiveX y los riesgos que entraña.

http://www.cert.org/reports/activeX_report.pdf
http://www.theregister.co.uk/content/4/15796.html

******************************************
4. Campaña free-PKI 2001 de CriptoLab

CriptoLab, ademas de contribuir con sus investigaciones al desarrollo
de sistemas de seguridad, también quiere popularizar el uso de las
Infraestructuras de Clave Pública (PKIs) al servicio de los usuarios
de internet, de la sociedad en general, y de fines no lucrativos.

CriptoLab ha decidido ofrecer sus desarrollos de PKI y parte de sus
instalaciones, de forma gratuita y altruista durante todo el año
2001, a todas aquellas Asociaciones, Grupos Profesionales, y a todos
aquellos colectivos altruistas que quieran disponer de una PKI
particular

Más información:
http://tirnanog.ls.fi.upm.es/CriptoLab/Proyectos/free-PKI%202001/Dumpi
ng.htm

Sobre PKI:
http://www.iec.csic.es/criptonomicon/susurros/susurros11.html

******************************************
5. Uno de cada cinco empresarios espía a sus trabajadores

Según una reciente encuesta de KPMG (www.kpmg.com), publicada este
martes, uno de cada cinco empresarios espía el correo de sus
empleados y su uso de Internet, práctica que llega en muchos casos al
despido cuando se descubre un mal uso, como visualización de
pornografía (despido en el 55% de los casos) o correos ofensivos o
difamatorios (despido en el 20% de los casos).

Más información:
http://www.zdnet.co.uk/news/2001/2/ns-20304.html

******************************************
6. La industria tecnológica se rearma contra el 'hacker'

El síndrome de un "Pearl Harbour digital" está presente en la vida
económica de la primera potencia. La creciente dependencia de la
tecnología ha llevado a que 19 empresas líderes de la industria
(Microsoft, AT&T, IBM, Hewlett Packard, Cisco, Oracle, Nortel,
KPMG...), algunas de ellas irreconciliables entre sí, hayan unido,
esta semana, fuerzas para compartir información sensible sobre
vulnerabilidades y fisuras de seguridad en su software y hardware,
que puedan ser utilizadas por intrusos.

La noticia completa en:
http://ibrujula.com/news/noticia.php3?id=13034

******************************************
7. Guninsky vuelve a la carga

El incansable cazaagujeros Georgi Guninsky nos descubre en esta
ocasión una importante vulnerabilidad en IIS, capaz de permitir la
obtención del código fuente de páginas con guiones en el servidor
(ASP, PHP, Perl, etc.) y un agujero en Media Player.

Puede encontrarse amplia cobertura de estos agujeros en las
siguientes direcciones:

Sobre Media Player e Internet Explorer:
www.hispasec.com/unaaldia.asp?id=813
www.hispasec.com/unaaldia.asp?id=801
www.hispasec.com/unaaldia.asp?id=799

Sobre agujeros en IIS:
http://www.hispasec.com/unaaldia.asp?id=805

Sobre agujeros:
http://www.iec.csic.es/criptonomicon/agujeros.html

******************************************
8. La noticia de HispaSec: La NSA publica una versión "segura" de
Linux

La Agencia de Seguridad Nacional (NSA) norteamericana acaba de hacer
pública una versión "segura" del popular sistema operativo Linux.

La noticia completa en:
http://www.hispasec.com/unaaldia.asp?id=795

Más información sobre seguridad en Linux:
http://www.iec.csic.es/criptonomicon/linux/

******************************************
Candados, cortafríos y otras herramientas

******************************************
9. Las tripas de Windows

En el sitio web Sysinternals encontrará utilidades avanzadas,
información técnica y código fuente relacionado con las
interioridades de Windows 9x, Windows Me y Windows NT/2000 difíciles
de encontrar por estar normalmente documentadas.

Herramientas de monitorizado e información de actividad del registro,
de los ficheros, de las conexiones de red, de las DLL cargadas, de
los procesos corriendo en la máquina, puertos TCP y UDP, inicios de
sesión, etc., son sólo alguna de las perlas incluidas en este sitio,
muchas de ellas junto con su código fuente.

http://www.sysinternals.com/

Herramienta enviada por Manuel Baena García.

¿Conoces alguna buena herramienta gratuita de seguridad que aún no
haya sido reseñada? Infórmame sobre su existencia escribiéndome a
criptonomicon@iec.csic.es.

******************************************
Parada y fonda

******************************************
10. DatumLex

En las páginas de DatumLex encontraréis noticias, legislación y
artículos, todos ellos desde una perspectiva legal, sobre temas
relacionados con el mundo de la protección de datos, la privacidad y
derechos afines, incluido el llamado 'hacktivismo'. También se presta
un servicio de noticias y boletines sobre los temas anteriormente
mencionados. Página muy recomendable para los que busquen un enfoque
jurídico-legal a materias relacionadas con las nuevas tecnologías de
la información y las comunicaciones.

http://www.datumlex.com/

¿Conoces alguna página web sobre seguridad y criptografía
(preferiblemente en castellano) que sea imprescindible y que yo aún
no haya mencionado? Házmela llegar. Envía la dirección de tu página
favorita a criptonomicon@iec.csic.es.

******************************************
Consejos y trucos

******************************************
11. Conexiones fiables a BD

Cada vez mayor número de sitios web utilizan páginas creadas en Java,
ColdFussion, ASP, Perl o PHP que permiten acceder a la base de datos
de la empresa. Estos productos y lenguajes interrogan a la BD,
procesan su respuesta y la devuelven en formato HTML que pueda
visualizar un navegador convencional. El acceso a través de Internet
posibilita una forma rápida y cómoda de acceder a la información
almacenada en la BD con el fin de recuperarla, modificarla o
insertarla. Ahora bien, para consultar a la BD primero es necesario
establecer una conexión con ella, para lo cual es necesario
suministrar unas credenciales, es decir, hay que autenticarse por
medio de un nombre de usuario y contraseña.

Admitámoslo, ¿quién no ha añadido alguna vez el login y password a la
cadena de conexión a la BD? Sentencias como la siguiente,
particularizada al lenguaje ASP, para, por ejemplo, acceder a través
de OLE DB a una BD en SQL Server, resultan de lo más común, por no
decir que son la regla habitual:

<%
  db.Open "Provider=SQLoledb; Server=ServidorBD;
catalog=NombreAplicac; uid=sa; pwd="
%>

La BD de datos verifica la información de inicio de sesión
suministrada para comprobar si se trata de un usuario autorizado, en
cuyo caso establece la conexión. Desgraciadamente, este tipo de
autenticación exige la inclusión del identificador de usuario y su
contraseña en la cadena de conexión. Esta cadena está codificada en
la página ASP (o PHP, Perl, etc.), de manera que si el código fuente
de la página cae en manos de un atacante, éste habría obtenido
automáticamente una cuenta válida de acceso a la BD. Si alguien
todavía considera descabellado que un atacante se haga con el código
fuente de la página, le basta con leer la noticia de Guninsky en este
mismo boletín (art. 7) o, si quiere hacer un poco de historia, que se
remonte a otros agujeros, como el ::$DATA, en el boletín #11, art. 2.

Para evitar estos problemas, se puede emplear una conexión fiable,
definida de la siguiente manera:

<%
db.Open "Provider=SQLoledb; Server=ServidorBD; catalog=NombreAplicac;
Trusted_Connection=Yes"
%>

En este caso, ya no aparecen el nombre de usuario y su contraseña,
sino que se exige la utilización de autenticación Windows, en la que
se pasa a la base de datos el nombre y contraseña de Windows del
usuario. Se requiere, claro está, que el servidor IIS utilice a su
vez autenticación integrada de Windows, para que se produzca el flujo
de identidad desde el navegador del usuario hasta el servidor de BD.

Más consejos y trucos en:
http://www.iec.csic.es/criptonomicon/consejos/

Participa enviando tus consejos y trucos a criptonomicon@iec.csic.es.

******************************************
Hablan los expertos

******************************************
12. Ineficacia de la ley ante los virus informáticos

Esta semana contamos con la colaboración en exclusiva de Eusebio del
Valle (www.datumlex.com), abogado penalista, especialista en
protección de datos y delitos informáticos. En su exhaustivo
artículo, nos explicará de manera magistral las limitaciones actuales
de nuestros modelos penales a la hora de combatir legalmente la
ominosa amenaza de los virus en Internet. Por la sencillez y claridad
de su exposición y profundidad de sus conclusiones, se trata de un
artículo imprescindible para conocer los problemas legales a los que
se enfrentan impotentes nuestros legisladores.


Seis causas que explican la ineficacia de la ley ante los virus
informáticos

Empecemos por la definición de la materia a tratar, existen
diferentes definiciones de virus informático,
e incluso conceptos del mismo, pero para estas líneas usaremos la
definición dada por Alfred Cohen en la conferencia IFIC/SEC de 1984:
"software maligno capaz de autoreproducirse", por maligno se entiende
con capacidad para causar daño en el hardware o software infectado, o
en ambos a la vez.

Sigamos despejando dudas; ya que a alguien se le puede ocurrir pensar
que al ser un virus un programa, debería estar protegido por la ley
de propiedad intelectual, de hecho podría ser también entendido como
un derecho a la libertad de expresión. Pero los sistemas legales
limitan los derechos del individuo cuando estos a su vez 'chocan' con
los derechos de los demás. En el sistema español el artículo 96.3 del
Texto Refundido de la Ley de Propiedad Intelectual, excluye a los
virus de las creaciones protegidas por el derecho de autor
(copyright), pensemos que si estuviese protegido por el derecho de
autor sería factible denunciar a las casas antivirus por destrucción
de obra intelectual.

Pero si bien no está protegido por la ley de propiedad intelectual,
sí que lo está como manifestación de la libertad de expresión. En
definitiva, un virus es creado por la mente humana.

Así existe una primera dificultad moral/política/legal para prohibir
el nacimiento del programa en cuestión, y en consecuencia el
desarrollo y la posesión de un código vírico no puede considerarse
ilegal.

Ahora bien, si el pensarlo, desarrollarlo o tenerlo no puede
incriminarse, usarlo ya es cosa diferente. El uso de ese código sí es
susceptible de ser regulado legalmente, con el uso se abandona el
mundo de las ideas y se entra en el mundo de la acción.

El legislador español regula el problema penal no dándole un
tratamiento especifico al virus, sino que lo regula desde la
perspectiva de los daños. Así en el Código Penal se dice: Artículo
264.

"1. Será castigado con la pena de prisión de uno a tres años y multa
de doce a veinticuatro meses el que causare daños...
2. La misma pena se impondrá al que por cualquier medio destruya,
altere, inutilice o de cualquier otro modo dañe los datos, programas
o documentos electrónicos ajenos contenidos en redes, soportes o
sistemas informáticos".

Se recogen, de esta manera, conductas como el mail-bombing,
introducción de virus en sistemas u ordenadores, caballos de Troya,
gusanos y bombas lógicas con el propósito de dañar.

Y ahora es cuando realmente comienzan los problemas legales.

1) La intencionalidad.- En el campo penal hay algo fundamental y es
precisamente ese 'propósito de dañar', es decir, la intención o
voluntad de causar ese daño. Este es pues el primer problema que la
ley tiene con respecto a los virus, a saber, obtener las pruebas,
llegar al convencimiento de que hay esa intención de dañar. En
definitiva, el Estado debe probar esa intención en el individuo. Y
eso no es fácil, más cuando el desarrollador es uno y el difusor
otro, (más de una vez un tercero que por novedad o por el simple
hecho de que sabe hacerlo, lo difunde sin más). Si no se llega a ese
convencimiento sobre la intencionalidad, (dolo), podría recurrirse a
la vía civil, y así el art. 1.902 C.C. dice: "El que por acción u
omisión causa daño a otro, interviniendo culpa o negligencia, está
obligado a reparar el daño causado", para la jurisprudencia la
existencia de daño no exige que la cosa mueble o inmueble quede
totalmente destruida o inutilizada, basta que la restitución del bien
a su estado anterior origine algún gasto, esfuerzo o trabajo. Se debe
aclarar que no siempre es la máquina o red en sí misma el objeto
dañado, normalmente es la información que ésta posee.

2) Prueba del daño y su valoración.-Valorar esa información perdida
para así valorar el daño es necesario, y no olvidemos que antes de
valorarlo hay que probar la existencia del daño causado, tanto en la
vía civil como por supuesto en la penal, (sin víctima no hay
asesinato, ¿verdad?). Esto, en la práctica, se convierte en un
problema serio con el que el Ministerio Fiscal y acusaciones deben
vérselas, y por tanto es una de las mejores bazas de las defensas
tanto en la fase de instrucción como en el acto de la vista oral, ya
que no todos los virus borran los discos duros o tienen un
comportamiento tan patente.

3) Extraterritorialidad.- Siguen los problemas, y ello por la propia
naturaleza o medio en que se mueven muchos virus informáticos. La
red.

Esta es sin duda la mejor baza procesal que podría tener la defensa,
para alargar enormemente un procedimiento o incluso para no llegar
nunca al final del mismo que, aunque discutible, no deja de ser una
técnica de defensa más.

Imaginemos por un momento, que un usuario de Internet desde X (con
nacionalidad C), introduce un código maligno, de un programa
realizado en un país H, en un servidor de British Virgin Island, para
que la copie un usuario en España, que a su vez tiene nacionalidad
Alemana.

El caso es de laboratorio jurídico, pero nada irreal; con menos
barroquismo, ocurre todos los días. A este ejemplo se le ha añadido
un paraíso fiscal, British Virgin Island (BVI), ya que ahora se están
convirtiendo en paraísos informáticos, no ratifican convenios
internacionales sobre materias "sensibles", (con lo cual, como
Estados independientes que son no les obliga el convenio
internacional que no han ratificado), complicando la solución
jurídica y favoreciendo en su suelo la instalación de servidores
warez, remailers anónimos y distribución de software, entre otros.

El problema se podría resumir con la siguiente pregunta, ¿qué ley es
la aplicable a un delito que tiene origen en un país, pero causa sus
efectos en otro u otros distintos?

En derecho español se enfrentan dos teorías aplicables y
contradictorias para resolverla, por un lado la teoría de la
manifestación de la voluntad que mantiene la competencia del juez del
lugar donde se pongan en práctica los actos para producir el
resultado lesivo, (en nuestro ejemplo, según esta teoría el juez de
BVI sería el competente para juzgar), y , por otro lado tenemos, la
teoría del resultado
que propone como competente al juez del lugar donde se produzca el
daño (claro que en estos casos el daño se produce en varios países a
la vez).

Ninguna de las dos teorías es predominante en España, (hay
jurisprudencia sobre ambas), pero a tenor de la Ley Orgánica del
Poder Judicial (art.23) y del Convenio de Bruselas, los tribunales
españoles son siempre competentes para conocer de los hechos cuando:
a) estos se planearon en España; b) se realizaron en cualquier parte
del mundo, pero por ciudadanos españoles; c) estén dirigidos a
usuarios en España; d) se produzcan en suelo español,
independientemente del lugar donde se hallen las máquinas o
servidores, y por supuesto e) también se consideran competentes si
los servidores utilizados están en suelo español.

4.- Intemporalidad.- La posibilidad de programar la ejecución del
código maligno en una determinada fecha. Ello, si el tiempo de
'hibernación' es muy largo puede plantear el problema de saber qué
legislación le es aplicable.

5.- La ejecución de la sentencia y auxilio judicial.- Más madera... y
el problema aumenta, ya que el mismo no sólo está en el
enjuiciamiento de la acción o delito sino en la ejecución de la
sentencia misma, en otras palabras, de qué vale una sentencia que nos
dé la razón (en España o en la China) si después no se puede
ejecutar, es decir, si después no se puede hacer efectiva en la
práctica, tendríamos un bonito papel que no sirve para nada;
evidentemente, si el daño o delito se provocó en diferentes países a
la vez, ¿cuánto tiempo tardará en ejecutarse esa sentencia en dichos
países?, ¿será ya eficaz?, ¿servirá de algo? Como es evidente, no
todos los países legislan la ejecución de sentencias de la misma
manera, como muestra un botón, Rusia permite la condena en país
extranjero de sus nacionales, pero después también deben cumplir
condena en Rusia.

Alguien puede pensar, para solucionar esto, que el procedimiento para
hacer efectivas las sentencias de otro país es el "execuatur",
previsto en el Convenio de la Haya (1961), del que España es parte,
donde se regula, también, la materia de auxilio judicial entre
Estados. Y ello está muy bien, pero en la práctica, la solicitud de
auxilio judicial con países como, por ejemplo, Sierra Leona, puede
llegar a ser dantesco; convencer a algunas autoridades locales de que
un virus ha nacido en su comunidad puede llegar a ser una tarea de
titanes (así China hasta hace muy poco se negaba a hablar del tema
con 'potencias occidentales'); convencerles después de que colaboren
será otra guerra, y por último la recogida de pruebas técnicas
normalmente se convertirá en un lugar lleno de agujeros por donde las
defensas se podrán colar tranquilamente ya que no existe un sistema
estandarizado de recogida de pruebas, (sumándole a ello que personal
especializado en recogida y análisis de pruebas técnicas no es fácil
de encontrar, España incluida, esto se une con el punto 2) antes
mencionado, 'el problema de la prueba'). Por último, pensar en
conseguir la extradición, en algunos casos, resulta milagroso ya que
aquí entran en juego diferencias culturales y políticas, y así un
creador de virus puede ser tenido como un criminal en un país, puede
ser un héroe en otro, tan solo hay que recordar la guerra
Palestino-Israelí para constatarlo, ya que ambos bandos están usando
también la red como campo de batalla.

No aludimos, siquiera, a que el creador del virus sea un menor de
edad (cosa nada extraña, por otra parte), en cuyo caso le sería
aplicable legislación específica en atención a sus años, (menores de
18 en España), por ejemplo, hasta no hace mucho en Rumania la minoría
de edad penal llegaba hasta los 21, o pensemos en el mundo árabe
donde, también, la edad penal varía de unos países a otros.

6.- Falta de denuncias.- Aunque estrictamente no es un problema
jurídico, sí repercute en él de manera directa, tal vez, si hubiera
más denuncias se ayudaría a concienciar aún más al legislador sobre
el problema y tal vez a buscar una solución global que, tal vez, es
la única que podría ser eficaz contra estos virus.

Pero, en la práctica las compañías afectadas prefieren guardar
silencio, antes que dar a conocer sus fallas de seguridad o,
simplemente, tienen miedo a sembrar la desconfianza hacia dicha
empresa. Por no mencionar que algunas de ellas compran al 'enemigo' y
punto, normalmente mediante contrato laboral, y si bien la moralidad
de ambas partes resulta en estos casos más que dudosa, ni siquiera
entiendo cómo no está prohibido por ley, lo cierto es que ocurre y se
publicita en prensa como algo de lo más normal; haciéndonos ver
claramente que el desarrollador de virus (en estos casos de
aceptación de su compra), y las empresas antivirus son, en
definitiva, las dos caras de la misma moneda; de hecho algún
desarrollador de virus que mantiene la creación como sistema de lucha
frente al sistema capitalista debería repasar, de nuevo, los
principios básicos del capitalismo, para darse cuenta que el virus
informático hace tiempo ya se convirtió en un elemento necesario más
del sistema al que pretende derrocar. El usuario es el que pierde, es
el afectado y, por regla general, debe comprar el remedio, eso al
menos hasta que la Administración Pública no desarrolle un antivirus
actualizable, de la mejor calidad, público y gratuito.

Por otro lado, tampoco los particulares solemos denunciar estos
hechos, en primer lugar, porque no todo fallo del sistema obedece a
causas víricas, y para la mayoría de usuarios domésticos diferenciar
el problema se convierte en una labor imposible; en segundo, porque
si se trata de un virus se opta por comprar un antivirus y borrar el
problema, antes que estar buscando responsables y exigiendo seguridad
en los sistemas que compramos. Es más cómodo obrar así, aunque
actualmente se puede denunciar incluso por correo electrónico, bien
en la Dirección General de la Policía Nacional
(tecnologicos@policia.es) como en la Dirección General de la Guardia
Civil (uco@gcivil.mir.es); también se puede hacer en el Juzgado, como
cualquier otra denuncia.

Así pues, y volviendo a nuestro tema, estas son algunas razones
jurídicas que explican la dificultad del problema, y el por qué pocos
o poquísimos creadores-difusores de virus son encontrados y/o
perseguidos. Se manejan cifras de 500 nuevos virus al mes en
Internet. En Estados Unidos, donde existen ya estadísticas oficiales,
se constató que de los 419 delitos informáticos elevados por el FBI
al ministerio fiscal menos del 5 % estaban relacionados con temas
víricos, en 1998. Este bajo número sólo se entiende por estas
dificultades legales a las que hemos aludido.

Aunque para alguno esta afirmación puede resultar escandalosa, e
incluso contraproducente, lo cierto es que, en mi opinión, la ley no
tiene, hoy por hoy, muchas armas contra los virus informáticos, y las
que tiene no dan respuesta eficaz a los mismos. Las seis causas
arriba mencionadas, que no son las únicas y a las que habría que
añadir las causas técnicas, se dan en mayor o menor medida, juntas o
combinadas en diferente proporción y manera, pero, ahí están y se
manifiestan impidiendo una solución al problema de los virus
informáticos.

Solución que habrá que buscar entre todos, comenzando por la
concienciación general.

Opina sobre este tema. Envía tus comentarios a
criptonomicon@iec.csic.es.

Otros artículos de expertos en:
http://www.iec.csic.es/criptonomicon/articulos/

¿Eres experto en algún área relacionada con la seguridad o la
criptografía y quieres colaborar con el Criptonomicón? Envía tu
artículo a criptonomicon@iec.csic.es.

******************************************
Virus y otros bichos

******************************************
13. Los últimos virus

Sección realizada por José Luis López (videosoft@videosoft.net.uy)

Resumen de virus reportados en los últimos 30 días.

- - - - ---
- - - - Nombre: Backdoor-JZ
- - - - Tipo: Caballo de Troya de acceso remoto
- - - - Fecha: 12/ene/01
- - - - Tamaño: 7,680 bytes

Se trata de un troyano, que suele transmitirse a través del IRC (pero
puede ser descargado en su computadora desde otras fuentes,
consciente o inconscientemente), y cuyo ejecutable está comprimido
con la utilidad UPX.

Es capaz de establecer conexiones TCP/IP por el puerto 30005 en la
computadora infectada. A través de esta conexión, un atacante puede
abrir, ejecutar y borrar archivos de la víctima, en forma remota
desde Internet.

Otras acciones posibles son cerrar Windows, enviar pings hacia el
exterior, etc.

Este troyano, además, es capaz de conectarse a los servidores de IRC
(Internet Relay Chat), y distribuirse a si mismo desde allí, a otros
usuarios que comparten los mismos canales.

- - - - ---
- - - - Nombre: I-Worm.Sint
- - - - Tipo: Gusano de Internet
- - - - Tamaño: 30 Kb (aprox.)

Se propaga a través del correo electrónico, utilizando el Outlook y
su libreta de direcciones.

El virus en si mismo, es un ejecutable de Win32 de unos 30 Kb de
largo, escrito en Visual Basic, que suele llegar en un adjunto de
nombre: "VICEVI_TEZA_ODVALA.TXT.EXE".

Note la doble extensión, truco que puede llegar a engañarnos,
haciéndonos ver este archivo como un "inocente" .TXT (archivos de
texto), cuando en realidad se trata de un ejecutable (.EXE).

"VICEVI_TEZA_ODVALA.TXT.EXE" es también agregado al registro de
Windows, para que sea ejecutado en cada reinicio del sistema.

En este caso, el virus no funcionará en aquellas instalaciones donde
Windows no esté en el directorio "C:\WINDOWS" por defecto, ya que no
utiliza la variable de entorno correspondiente, sino la cadena
textual contenida en su propio código.

El worm se conecta con el Outlook, a través de las funciones MAPI de
Windows. Es capaz de enviarse a todos los contactos obtenidos de la
libreta de direcciones.

- - - - ---
- - - - Nombre: Troj_Azpr
- - - - Tipo: Caballo de Troya
- - - - Destructivo: Si
- - - - Alias: BackDoor-G2.svr.gen, AZPR
- - - - Tamaño: 1,147,299 bytes

Es un destructivo troyano con características de backdoor, adjunto a
la herramienta para recuperar passwords en archivos ZIP, llamada
"Advanced Zip Password Recovery Tool".

Actúa como servidor, habilitando el acceso remoto de un hacker, a la
computadora infectada. Una vez ejecutado, se mantiene en memoria.

El troyano crea dos archivos en la carpeta C:\WINDOWS. El primero es
una copia de si mismo, y el segundo es un componente detectado por
algunos antivirus como Troj_Sub7.Muie.

Luego de esto, el trojan crea y ejecuta el archivo:
C:\WINDOWS\APPL_.EXE. Se trata de la herramienta original conocida
como "Advanced Zip Password Recovery Tool". De este modo el usuario
pensará que ejecutó esta herramienta, y no sospechará la presencia
del troyano.

Luego, queda residente en memoria, y aguarda los comandos que
recibirá desde el cliente (la otra parte de este caballo de Troya, la
cuál ejecuta el atacante).

También modifica las entradas del registro necesarias para ser
lanzado cada vez que el usuario corra otros programas.

El procedimiento para borrar este troyano de su sistema, está
explicado paso a paso en nuestro sitio http://www.videosoft.net.uy.

- - - - ---
- - - - Nombre: Worm.Hermes
- - - - Tipo: Gusano de e-mail
- - - - Tamaño: 20 Kb aprox. (comprimido)

Se trata de un gusano que se propaga a través del correo electrónico,
usando para ello el Outlook de Microsoft.

El worm en si mismo es un ejecutable de unos 20 Kb de largo
comprimido (descomprimido ocupa unos 60 Kb), escrito en Visual Basic.

Para conectarse al Outlook, utiliza las funciones MAPI de Windows.

De la libreta de direcciones, toma los contactos a los que se
enviará, en mensajes que poseen como archivo adjunto, uno tomado al
azar desde las siguientes variantes:

  Seti@home 3.x to 4.0 upd.exe
  Seti@home_twk.exe
  Seti_patch.exe
  Lunetic!.exe
  CIH.exe
  Energy.exe
  ftip.exe
  Navidat.exe
  Click_ME!.exe
  Cenik.exe
  Lunetic.scr
  fucking.scr
  micro$haft.scr
  matrix.scr
  reboot.scr
  Pamela.scr
  techno.scr
  funny!.scr
  Hermes.scr
  School_in_da_flame.scr

Cuando se ejecuta, el gusano despliega un mensaje para disimular su
actividad, con un falso error por falta de memoria, y algunas
indicaciones para obtener más memoria libre.

- - - - ---
- - - - Nombre: Demiurg (Demig)
- - - - Tipo: Infector de archivos, multipartite
- - - - Tamaño: 16,354 bytes
- - - - Alias: Demig.16354, X97M.Demiurg.A, X97M/Demiurg, W32/Demiurg,
Pe_emiurg.A, Bat_demiurg.A, Demiurg.17584, X97m_demiurg.A,
W32.Demiurg.16354.dr, Demiurg.16354, Demiurg.16354.Bat

Este virus multipartite (se les llama así a aquellos virus capaces de
infectar diferentes tipos de archivos), es capaz de infectar archivos
MS-DOS, Windows (Win32) y Excel.

Bajo DOS, infecta archivos .COM, .EXE y .BAT.

Bajo Windows, infecta archivos ejecutables PE (Win32) y la librería
KERNEL32.DLL.

Y en Office, puede crear libros Excel conteniendo el virus (virus
dropper).

El virus en si mismo es un ejecutable Win32 en formato PE, y es capaz
de realizar todas sus funciones, solamente cuando se ejecuta bajo
Windows.

Otros componentes infectados serán convertidos en "virus dropper", o
sea que esconden el cuerpo del virus y lo liberan bajo determinadas
circunstancias. De esta manera, el virus no se propaga directamente
desde un archivo infectado, pero utiliza técnicas para liberar copias
de si mismo desde estos archivos.

Bajo Win32, el virus permanece residente en memoria. El archivo
KERNEL32.DLL infectado, engancha todas las funciones de acceso a los
archivos (abrir, copiar, mover, cambios de atributos), e infecta
archivos .COM, .EXE y .EXE de Win32 (PE).

- - - - ---
- - - - Nombre: HTML/LittleDavinia
- - - - Tipo: Gusano de HTML, VBS, correo y Macro

El HTML/LittleDavinia, sólo afecta a aquellos que tengan instalado en
su PC, el Word 2000.

Se trata de una mezcla de gusano de HTML, Visual Basic Script, correo
y macro, programado en España por quien firma como Onel2,
supuestamente en referencia al autor del Loveletter, el filipino Onel
de Guzmán.

Este virus utiliza el cliente de correo MS Outlook para propagarse.
Sin embargo, el gusano utiliza una manera muy sofisticada de ingresar
a nuestra computadora.

Primero, recibimos un mensaje infectado, que contiene un script que
automáticamente abre una ventana del Internet Explorer después que el
mensaje es leído, iniciándose una conexión al sitio o página del
hacker o atacante.

El virus posee además otro script que a su vez abre un documento
Word, localizado en el mismo sitio mencionado anteriormente. Este
documento contiene un virus de macro, que sin el conocimiento del
usuario, desactiva la protección contra virus del Word 2000. De este
modo, no seremos avisados de la presencia de macros en ese documento,
el cuál es abierto y ejecutado sin nuestra acción directa, y sin que
nos enteremos en ningún momento de este proceso.

Para hacer todo esto, el virus explota la vulnerabilidad conocida
como "Office 2000 UA Control Vulnerability", descubierta en el mes de
mayo de 2000, y para la que ya existe un parche.

Luego de ello, el gusano accede al Outlook, captura la lista de
contactos de la libreta de direcciones, enviándoles a todos ellos,
mensajes (iguales al que recibimos), pero conteniendo enlaces al
sitio Web descripto arriba.

El documento de Word descargado de la página, se llama LD.DOC, y como
vimos, contiene macros que sólo funcionan en Word 2000.

El virus "Davinia" es altamente destructivo. Reemplaza todos los
archivos localizados en todos los discos duros de nuestra
computadora, por un archivo que despliega un mensaje en español
cuando es ejecutado. El archivo que genera estos archivos, se llama
LITTLEDAVINIA.VBS, y se ejecutará de manera automática. Este es el
mensaje que presenta:

  VBSScript: Onel2 - Melilla

  Hola, tu nombre es [nombre del usuario].
  Tu email es [e-mail del usuario]
  Yo soy Onel2, y vivo en Melilla
  una ciudad del norte de Africa.
  Estoy enamorado de una chica llamada Davinia.
  Ella es la más guapa del mundo.
  Es como una diosa.
  Igual que yo me contagie de amor
  de Davinia, tus archivos se van a
  contagiar de amor de esta página
  Davinia(chica) y Davinia(virus) rompen corazones y archivos.
  littledavinia version 1.1 esta en camino...

  [ Anular ]  [ Reintentar ]  [ Ignorar ]

Como los archivos no son borrados ni renombrados, sino suplantados
por el contenido de este archivo, la recuperación de los originales
es imposible, salvo que se haga desde algún respaldo total de
nuestros discos.

- - - - ---
- - - - Nombre: WM97/Chronic-A
- - - - Tipo: Virus de macro de Word 97

Se trata de un virus que posee un complejo mecanismo, el que bajo
ciertas condiciones, puede llegar a borrar los valores de la CMOS.
Estos valores incluyen datos como la hora y la fecha, y sobre todo,
la información necesaria para que el sistema sea reconocido al
encenderse la PC, datos como tipo de hardware instalado, discos
duros, etc.

- - - - ---
- - - - Nombre: W32/Navidad-B (Emanuel)
- - - - Tipo: Ejecutable de Win32, Gusano
- - - - Tamaño: 16,896 Bytes
- - - - Alias: I-Worm/Navidad, W32/Emanuel, Troj_Emmanuel,
W32.Navidad.16896, Emmanuel, Navidad.E, Navidad.B

Este virus ya ha sido reportado (y descripto tanto en Criptonomicón
#79, como en nuestro sitio, el pasado 30 de noviembre de 2000), sin
embargo, es en los últimos días que ha sido visto activo en una gran
cantidad de lugares y países, por lo que incluso en algunos medios se
ha anunciado su fecha de descubrimiento (en forma errónea) como la
del 8 de enero de 2001.

Es una variante del virus W32/Navidad, pero en esta versión, llega a
nosotros en un mensaje con un adjunto llamado EMANUEL.EXE.

El gusano intentará leer los mensajes de la carpeta de recibidos, y
se enviará a las direcciones de los remitentes allí conseguidos.

Debido a las características de este virus, y las modificaciones
realizadas en el registro, la forma de sacar este virus de un sistema
infectado es larga y engorrosa, y está descripta paso a paso en
nuestro sitio: http://www.videosoft.net.uy

- - - - ---
- - - - Nombre: Pe_Wit.A
- - - - Tipo: Virus infector de ejecutables Win32 (PE)
- - - - Alias: WIT.A
- - - - Tamaño: 4,096 bytes

Se trata de un virus "de compañía" o "companion" (se les llama así a
los virus que modifican el nombre de los archivos originales y toman
el lugar de estos, de modo que cuando el programa original es
llamado, en realidad se ejecuta primero el virus). Infecta solo los
archivos .EXE del formato PE (Portable Executable). Luego de la
infección, los archivos .EXE son renombrados como .WX3.

- - - - ---
- - - - Nombre: Troj_Bat2exec
- - - - Tipo: Caballo de Troya
- - - - Alias: BAT2EXEC
- - - - Destructivo: Si
- - - - Tamaño: 9,384 bytes

Se trata de un destructivo troyano, capaz de formatear el disco duro
cuando se reinicia el sistema.

Cuando se ejecuta, despliega este texto:

PLEASE WAIT WHILE PROGRAM LOADS..

En ese momento sobreescribe el archivo AUTOEXEC.BAT con el código
necesario para formatear automáticamente todas las unidades de disco
disponibles en el sistema. Además, intenta borrar archivos en todas
las unidades de disco, utilizando el comando DELTREE.

Nota: Existe una utilidad de DOS llamada también BAT2EXEC que permite
compilar un archivo de lotes (.BAT) para convertirlo en ejecutable
(.EXE).

- - - - ---
- - - - Nombre: W97M/Michael.A y W97M/Michael.c
- - - - Tipo: Virus de macro de Word 97
- - - - Alias: Michael.A, W97M/Michael.c.gen, W97M_Michael.Kbd
- - - - Origen: Filipinas

Se trata de un virus de Word 97 polimórfico, contenido en un módulo
llamado MYCKL2_6.

Cuando un documento o una plantilla infectada es abierta, el virus
intenta deshabilitar la protección contra virus de macros de Word 97,
y la opción SaveNormalPrompt. Luego borra los macros existentes y se
copia a si mismo a la plantilla NORMAL.DOT, y a cualquier otro
documento abierto en ese momento.

Bajo determinadas circunstancias, el virus esconde las carpetas
FUENTES, TECLADO, MOUSE, e IMPRESORAS del Panel de Control.

También modifica archivos relacionados con el teclado, modificando el
valor de las teclas pulsadas por otros.

El resto de las rutinas del virus (payloads), actuarán de acuerdo a
los macros y acciones que sean activadas por el usuario en una sesión
de trabajo normal con el Word.

Estas acciones incluyen la impresión de un Curriculum Vitae,
presumiblemente del autor del virus, la visualización de un
Curriculum interactivo usando el Microsoft Assistant para darle al
usuario diferentes opciones a seleccionar de una lista que puede
cambiar al azar, y el borrado de archivos como C:\AUTOEXEC.BAT.

Una variante, llamada W97M/Michael.C, deshabilita algunas opciones
del menú de Word, y muestra un mensaje al respecto.

- - - - ---
- - - - Nombre: Pe_Resur
- - - - Variantes: Resur.b
- - - - Tamaño: 163,840 bytes
- - - - Tipo: Infector de ejecutables Win32
- - - - Alias:  Win32.Resur, Resur, W32/Resur, W32.Resurdbg,
Win32/Resurrection

La primera vez que se ejecuta, este virus infecta archivos PE
(ejecutables de Win32) en la carpeta C:\WINDOWS. Los archivos
infectados no se comportarán normalmente y producirán algunas veces
errores de operaciones ilegales al funcionar. Más allá de ello, este
virus no posee una rutina destructiva, por lo que parece ser parte de
un experimento de nuevas técnicas a explotar en el futuro.

Cuando el virus se ejecuta, se muestra un botón de [ACEPTAR] en una
caja de mensajes titulada:

  Win32/Resurrection by Tcp/29A

El virus se mantiene entonces activo en memoria, y cuando un archivo
infectado es abierto, toma el control, ejecuta su rutina de infección
y finalmente le devuelve el control al archivo.

El proceso iniciado (thread), sigue activo en segundo plano mientras
el proceso principal iniciado por el ejecutable infectado que lo
contiene está presente. Este proceso intentará escanear las carpetas
y subcarpetas de todos los discos disponibles, infectando los
archivos ejecutables Win32 PE (Portable Executable).

El virus también contiene este texto, el cuál solo es mostrado en
algunos casos.

  I already told you this but...
  Warning! Don't close this window
  Win32/Resurrection by Tcp/29A
  Hey you, stupid
  29A

* Variante: Resur.b

Es una re-hechura del virus original. En lugar de mostrar el mensaje
anterior, el virus obliga al navegador de Internet en uso, a abrir el
sitio Web: "http://sennaspy.tsx.org". Esta versión solo contiene este
texto:

  Senna Spy Fenasoft 2000 Virus

Algunas veces, los archivos infectados no infectarán otros archivos.
Tampoco se ejecutarán otras rutinas destructivas.

- - - - ---
- - - - Nombre: Bat_Exitwin.A
- - - - Tipo: Caballo de Troya de archivos BAT
- - - - Alias: Exitwin.A
- - - - Destructivo: Si
- - - - Tamaño: 26,112 bytes

Cuando se ejecuta por primera vez (puede ser un archivo bajado de
Internet, adjunto a un mensaje, etc.), este troyano hace que la
computadora se reinicie continuamente, cada vez que la encendemos.

Se trata de un archivo .EXE, que al ejecutarse, libera los archivos
AUTOEXEC.BAT e INSTALL.BAT en la carpeta temporal de Windows.

Luego, ejecuta INSTALL.BAT, el cuál examina la presencia del archivo
AUTOEXEC.BAT en el directorio raíz de C:\. Si existe, lo renombra
como AUTOEXEC.BAK y copia el archivo AUTOEXEC.BAT del virus.

Si no existe, copia directamente su propio AUTOEXEC.BAT

Luego muestra el siguiente mensaje y resetea la computadora,
reiniciando el sistema.

  You've been fucked by Th3 H@cker

- - - - ---
- - - - Nombre: Troj_Sub7.Muie
- - - - Tipo: Caballo de Troya
- - - - Alias: SUB7.MUIE, BackDoor-EP.svr
- - - - Variantes: Actualización de BackDoor-G2.svr.21

Es un destructivo troyano, que permite el acceso remoto a la
computadora infectada, obteniendo información del sistema, y
comprometiendo la seguridad de la red.

Como casi todo troyano clásico, consta de dos partes, el programa
cliente y el servidor.

El servidor se instala en la computadora atacada (generalmente es
ejecutado por el usuario que se convierte en víctima, engañado sobre
el verdadero uso del archivo, y sin tomar precauciones como las de no
ejecutar jamás archivos no solicitados recibidos vía e-mail, etc.).

Una vez instalado, y cada vez que la víctima se conecta a Internet,
el caballo de Troya se pone a la escucha por el puerto 27374 (por
defecto), esperando el acceso de un usuario que esté utilizando la
parte cliente del trojan.

Una vez que se establece la conexión, se pueden realizar diferentes
acciones sin el conocimiento del usuario infectado, tales como
captura de la información de dicha computadora y de los datos del
usuario, captura de todo lo tecleado por el usuario, conectado o no a
Internet, transferencia de archivos, y páginas HTML, etc.

La distribución de este archivo, generalmente se hace en un
ejecutable Win32 (PE), simulado en una imagen JPG o BMP.

El troyano también registra la extensión .DL como un tipo de archivo
ejecutable. Esto permite al atacante descargar archivos en la
computadora de la víctima y ejecutarlos.

Como esta extensión no está relacionada normalmente con archivos
ejecutables algunos antivirus no los detectarán, y la víctima
ignorará su existencia.

- - - - ---
- - - - Nombre: VBS/Mill.f@MM
- - - - Tipo: Gusano de Visual Basic Script
- - - - Fecha: 26/dic/00
- - - - Tamaño: 5,989 bytes

Este virus se ejecuta solo si tenemos habilitado el Windows Scripting
Host (WSH) en nuestro PC, y tiene la habilidad de propagarse tanto a
través del programa de chat mIRC, como de las funciones MAPI (correo
electrónico). De ambas formas se recibe un adjunto con el nombre:
"SeasonGreeting.txt.vbs".

Note la doble extensión, lo que hace que el virus pueda mostrarse
como un inocente .TXT, escondiendo su condición de archivo .VBS

El gusano se enviará a todos los contactos de la libreta de
direcciones de Windows (Windows Address Book) con las mismas
características del mensaje recibido anteriormente.

Si está presente el archivo C:\MIRC\SCRIPT.INI, el mismo será
sobrescrito con las instrucciones necesarias para enviar el archivo
SEASONGREETING.TXT.VBS a todos los usuarios de IRC que se unan al
mismo canal de chat en que se encuentra la computadora infectada.

- - - - ---
- - - - Nombre: VBS/Tqll-A
- - - - Tipo: Gusano de Visual Basic Script
- - - - Alias: VBS/Tqll.a@MM, VBS/Tqll-A
- - - - Tamaño: 10,390 bytes
- - - - Fecha: 29/dic/00

Si la persona recibe un mensaje con el asunto "New Year !", y pincha
sobre el adjunto "HAPPYNEWYEAR.TXT.VBS", el virus se instalará en su
unidad de disco.

Por defecto, Windows ocultará la segunda extensión, mostrando el
enlace como "HAPPYNEWYEAR.TXT" (para que Windows visualice todas las
extensiones, debemos ir a Inicio, Configuración, Opciones de carpetas
en Windows 98, o en cualquier menú Ver de Windows 95, en Opciones --u
Opciones de carpetas--, y en la opción Ver, DESMARCAR la opción
"Ocultar extensiones para los tipos de archivos conocidos" o
similar).

Cuando el virus se instala, libera un caballo de Troya, creando el
ejecutable 3K.EXE en el directorio C:\WINDOWS, el cuál intentará
bajar otro archivo (TEEN.EXE) desde varios sitios de Internet. 3K.EXE
es un archivo de unos 9 Kb, y consiste en el código encriptado del
troyano.

Este troyano se ha estado distribuyendo en algunos newsgroups
(alt-sex, etc.), con el nombre de QUICKFLICK.MPG.EXE. La doble
extensión, también podría engañar al usuario, haciéndolo creer se
trate de un video .MPG.

Cuando este Trojan se ejecuta, intentará descargar y ejecutar en
forma silenciosa otro programa desde algunos sitios Web. Este
programa es una copia del troyano Troj/Subseven.

Luego de esto, el gusano intentará reenviarse a través del Outlook a
todos los usuarios de la libreta de direcciones.

El virus no funciona si no se tiene instalado el Windows Scripting
Host.

- - - - ---
- - - - Nombre: VBS.Sorry.A
- - - - Variantes: VBS/TTFloader.A, VBS/Pica.worm.gen
- - - - Tipo: Gusano de Visual Basic Script
- - - - Tamaño: 10,178 bytes
- - - - Fecha: 20/dic/00

VBS.Sorry.A es un gusano de Visual Basic Script capaz de copiarse a
si mismo a múltiples directorios del disco duro local y de unidades
de red. También genera archivos de configuración del programa de chat
"mIRC" para conectarse con computadoras infectadas por el troyano
SubSeven, en las cuáles es capaz a su vez de copiarse y ejecutarse.

Además, puede borrar archivos y carpetas de la computadora infectada.

Uno de los posibles síntomas de la infección que el usuario podrá
apreciar es la lentitud de su máquina cuando el virus está activo.

- - - - ---
- - - - Nombre: W32/HLLP.Backdoor.Yai
- - - - Tipo: Virus de compañía
- - - - Origen: China
- - - - Alias: HLLP.Yai, HLLP.Yai.274944, PE_YAI.SER,
Trojan.YAI.Mimi.Srv, W32.HLLP.YAI, W32/HLLP-Yai, Win32.HLLP.Yai

Más arriba, explicábamos el significado de "virus de compañía". En
este caso, el W32/HLLP.Backdoor.Yai se copia a si mismo con el nombre
del archivo original, y renombra a éste con la extensión .TMP. Este
archivo (.TMP) es puesto con los atributos de oculto (+H).

Ejemplo:

  WRITE.EXE
  WRITE.TMP

WRITE.EXE contiene el virus, y WRITE.TMP es el archivo original
renombrado. El archivo WRITE.TMP es comprimido durante la infección
usando LZH, pero seguirá ejecutándose y funcionando correctamente.

Su método de infección es del tipo "acción directa". Busca e infecta
archivos ejecutables en la unidad local, y los renombra, copiándose
luego a si mismo con el nombre original del archivo "infectado", como
vimos.

- - - - ---
- - - - Nombre: VBS/MBot-A
- - - - Tipo: Gusano de Visual Basic Script
- - - - Alias: MatrixBot

El gusano puede llegar a nosotros en un mensaje con el asunto
"NewsMatrixBot [Test Run only]" y un adjunto llamado: MATRIXBOT.VBS.

Si se ejecuta este archivo (doble clic sobre el adjunto), el gusano
se copia una vez en la carpeta C:\WINDOWS, con el nombre de
WIN32DLL.VBS, y dos veces en la carpeta C:\WINDOWS\SYSTEM con los
nombres de MSKERNEL32.VBS y MATRIXBOT.VBS.

También modifica el registro de Windows, para que WIN32DLL.VBS y
MSKERNEL32.VBS se ejecuten en cada reinicio del sistema.

Además, se modifica la página de inicio del Internet Explorer para
que apunte a esta dirección: http://www.ashoppe.net.

Una vez en memoria, el gusano es capaz de propagarse a todos los
contactos de la libreta de direcciones del Outlook, adjuntándose en
cada mensaje el propio gusano (desde el tercer archivo copiado en el
sistema: MATRIXBOT.VBS).

- - - - ---
- - - - Trojan: Namaz Trojan
- - - - Tipo: Caballo de Troya
- - - - Alias: Win32.Namaz Trojan

Este caballo de Troya, puede venir en un archivo llamado "HAPPY
CHRISTMAS.EXE". Cuando éste es ejecutado, el virus modifica el
archivo C:\AUTOEXEC.BAT de modo que en el arranque de Windows, se
muestre el mensaje "Happy_Namaz!. Presione cualquier tecla para
continuar . . .".

También modifica el registro, de modo que cierra Windows apenas se
ejecuta.

Antes de ello, el virus crea varios directorios, y cada vez que lo
hace, también se ejecuta la calculadora de Windows (calc.exe),
generándose varias instancias simultáneas de dicha aplicación. La
cantidad total de directorios creados (y de calculadoras
ejecutándose) es siempre una cantidad al azar, pero suele ocurrir que
el sistema agote sus recursos, al estar ocupada su memoria por la
cantidad de calculadoras cargadas en ella, antes que el troyano
culmine su tarea.

- - - - ---
- - - - Nombre: Dropper_12m
- - - - Tipo: Infector de archivos
- - - - Destructivo: Si
- - - - Tamaño: 4,096 bytes

Se trata de un virus de DOS (que funciona en Windows), capaz de
sobrescribir el sector de booteo (BOOT Sector) del disco duro y las
dos tablas de particiones del mismo (FAT, File Allocation Table).

Cuando se ejecuta, el virus busca la existencia de un archivo llamado
STEALTH.COM. Si lo encuentra, lo utiliza para infectar el sistema.

Para ello, se engancha (hook) a las interrupciones que el DOS utiliza
para el manejo de los errores críticos, y las operaciones de división
por cero. Cuando algunas de estas interrupciones son activadas por el
sistema, el virus actúa, sobrescribiendo (borrando), el sector de
arranque del disco duro (BOOT sector), y también ambas FAT. Con esto,
no se podrá volver a arrancar el sistema desde el duro.

- - - - ---
- - - - Nombre: PE.Begemot.A
- - - - Tipo: Infector de archivos PE
- - - - Alias: Win95.Begemot, Begemot.A, PE_Begemot.A-O
- - - - Tamaño: 8,192 bytes

Se trata de un virus residente en memoria, polimórfico, de apenas 8
Kb, que una vez instalado es capaz de infectar todos los archivos con
formato PE (Portable Executable) de Windows, incluyendo ejecutables
(EXE), y salvadores de pantalla (SCR), que sean accedidos por el
sistema. También infecta archivos comprimidos con la utilidad RAR,
agregando un archivo infectado (BEER.EXE) dentro de los mismos.

El virus usa llamadas al sistema, que solo funcionan en Windows
95/98, no pudiéndose extender bajo Windows NT.

Posee algunos fallos, y ocasiona congelamientos del sistema en
algunas ocasiones.

Es capaz de comunicarse con un módulo externo que lo puede controlar
desde una interface tipo consola. Desde esta consola por ejemplo, se
puede habilitar o deshabilitar las rutinas de infección.

Utiliza ingeniosos métodos para saltar de ring3 a ring0, etc. Usando
estas habilidades, el virus puede deshabilitar la parte residente de
algunos antivirus.

También es capaz de borrar archivos de algunos antivirus en ese
punto.

El código principal, contiene el siguiente texto, que no es mostrado:

  Virus Win98.BeGemot by Benny/29A

- - - - ---
- - - - Nombre: PE_Funlove.4099
- - - - Tipo: Infector de archivos Win32
- - - - Alias: W32/Funlove
- - - - Tamaño: 4.099 bytes

Cuando se ejecuta, este virus crea un archivo llamado FLCSS.EXE en
C:\WINDOWS\SYSTEM.

Infecta entonces a todos los archivos PE (EXE, SCR, y OCX), en las
carpetas Archivos de programas, Program Files y Windows9x/WinNT,
incluyendo sus subcarpetas.

Mientras el EXPLORER.EXE se encuentre en memoria, el virus se volverá
a ejecutar cada vez que el sistema se reinicia. Como EXPLORER.EXE y
otros archivos del sistema, se ejecutan siempre que Windows es
cargado, este virus no puede ser limpiado desde Windows, ni aún desde
una ventana MS-DOS bajo Windows, sin desactivarlo antes de la
memoria.

Bajo un entorno de Windows NT, el virus modifica el testeo de
integridad de NTOSKRNL.EXE (el kernel de Windows NT), modificando el
archivo cargador de este (NTLDR), el cuál está ubicado en el
directorio raíz, para que no despliegue un mensaje de error (pantalla
azul). Luego, también es modificado el archivo NTOSKRNL.EXE ubicado
en el directorio \WINNT\SYSTEM32. Esto le permite tomar los
privilegios del administrador, leyendo y modificando todos los
archivos. Además, intenta ejecutarse como un servicio.

El virus infecta todos los archivos en formato Win32 Portable
Executable (PE), tales como .EXE, .SCR, y .OCX en Windows 9x y NT.
También busca en todas las carpetas compartidas en una red con acceso
de lectura permitido e infecta los archivos con esos formatos en
ellos.

- - - - ---
- - - - Nombre: W97M/Digma
- - - - Tipo: Virus de macro
- - - - Fecha: 15/dic/00

Este virus se propaga a través de documentos infectados de Word 97 y
2000.

La infección comienza cuando el virus escribe su código a la
plantilla "Normal.dot". Una vez que esta plantilla es infectada,
todos los documentos usados en el sistema, serán infectados.

El virus realiza las siguientes acciones:

Deshabilita las opciones de alertas de virus de macros en Word.

Deshabilita la pregunta para grabar la plantilla normal.

Deja en 4 la cantidad de documentos usados recientemente.

El día 13 de cada mes, cuando se abandona Word y hay un documento
abierto, el virus realiza estas acciones:

Todas las apariciones en el documento de las letras "a" y "o" son
reemplazadas por la palabra FUCK.

Se inserta el siguiente texto, en grandes letras, al comienzo del
documento.

  DIGITAL
  MADMAN

- - - - ---
- - - - Nombre: W97M/Media
- - - - Tipo: Virus de macro
- - - - Fecha: 15/dic/00

Se propaga a través de documentos infectados en Word 97 y 2000.
Consiste en el macro "ThisDocument". Cuando un documento infectado es
abierto, el virus realiza las siguientes acciones:

Deshabilita la advertencia de virus de macros en Word.

Deshabilita la opción para grabar la plantilla normal.

En forma randómica, muestra este mensaje:

  Dat mediaheekmens SUCKS!!!

Para activar la infección, el virus graba su código a la plantilla
global, "Normal.dot". Una vez que esta plantilla es infectada, todos
los documentos usados en el sistema serán infectados.

- - - - ---
- - - - Nombre: W32/Press (Win32.HIV)
- - - - Tipo: Infector de archivos Win32 y Gusano de Internet
- - - - Alias: PE_HIV, VBS/Press, W32.HIV, W32/Press.6380,
W32/Press.6380.dr, W32/Press.6382, W32/Press.6382.dr, W32/Press.6386,
W32/Press.6386.dr, Win32.HIV

Es un peligroso virus residente en memoria, que infecta archivos
ejecutables Win32 (PE EXE) y archivos de instalación de Windows
(MSI). Es capaz de actualizarse desde Internet, y tiene capacidades
para propagarse vía e-mail.

El virus está encriptado y utiliza una tecnología llamada "Entry
Point Obscuring", para esconderse dentro de los archivos infectados.
Su tamaño es de aproximadamente 6 Kb, y ocupa hasta 8 Kb una vez en
memoria.

Utiliza varias técnicas novedosas para evitar ser examinando
(técnicas anti-debugging), y es capaz de congelar la PC si detecta la
presencia del SoftICE o cualquier otra herramienta del tipo
"debugger" en el sistema (estas herramientas permiten correr un
programa o proceso paso a paso y examinar su código).

El virus intenta deshabilitar la protección de archivos de Windows,
como el SFC. Para ello actúa sobre archivos responsables de dicha
protección. Sobreescribe el archivo DEFAULT.SFC creando uno de cero
bytes (en Windows 98), o SFCFILES.DLL (en Windows 2000). Esto sin
embargo funciona solo en Windows 98, no bajo Windows 2000, ya que el
sistema bloquea el acceso a este DLL, y además es capaz de restaurar
el archivo SFCFILES.DLL. En Windows 98, la eliminación del archivo
DEFAULT.SFC impide que la herramienta conocida como Comprobador de
archivos del sistema (SFC por sus siglas en inglés), actúe.

Para infectar los archivos *.EXE, el virus examina el directorio
actual (donde se ejecutó el archivo infectado), y escribe su propio
código al final del archivo que infecta.

Si se ejecuta, el virus queda en memoria como un componente del
programa infectado, intercepta las funciones de acceso a los
archivos, e infecta a los ejecutables que son llamados por aquél. Es
capaz de permanecer activo en memoria hasta que la aplicación
infectada es finalizada.

El virus es capaz de interceptar el acceso a archivos MSI (archivos
del Instalador de Windows), abrirlos, buscar por archivos ejecutables
PE en ellos, e infectarlos sobreescribiendo la rutina de entrada.

También busca archivos *.HTML en el directorio actual, y los
reemplaza por archivos XML, agregándoles la extensión .XML, además de
un script.

Los archivos XML son archivos en lenguaje de formato extensible, que
incorporan varias funciones y comandos que pueden ejecutarse bajo el
Windows Scripting Host (WSH) de Windows. Pueden modificarse con un
simple editor de texto.

El virus esconde los archivos afectados (XML) con un truco: cambia el
registro del sistema para impedir que Windows muestre las extensiones
XML y además se visualice el icono estándar para archivos HTML. Como
resultado, los archivos HTML afectados (ahora XML), son mostrados por
el Explorer como HTML. Así que un archivo "NOMBRE.HTML.XML" se
mostrará en realidad como "NOMBRE.HTML" y con el icono de los HTML.

Abre además la libreta de direcciones (Windows Address Book), y toma
de allí las direcciones a las que envía un mensaje con el archivo
adjunto PRESS.XML.

Este archivo es el mismo script XML que es usado por el virus al
infectar los archivos HTML.

- - - - ---
- - - - Nombre: Troj_Sub7drpr.B
- - - - Tipo: Caballo de Troya
- - - - Tamaño: 1,686,447 bytes
- - - - Alias: Multidropper.z, SUB7DRPR.B , Trojan.Win32,
TrojanRunner.RSP.a


Aparenta ser una captura de una webcam (cámara web). Posee formato
.RM (Real Media), y su nombre es VIDEO.RM, pero en realidad se trata
de un "dropper".

Un "dropper" es aquél programa que ha sido modificado para llevar a
cabo la instalación de un virus en el sistema. Los "droppers" ocultan
el cuerpo del virus que liberan, de tal modo que un antivirus puede
no detectarlo.

En este caso, el archivo esconde al troyano Troj_Sub7.401315, una
variante del SubSeven.

Cuando VIDEO.RM es abierto (doble clic sobre él), se ejecutará la
aplicación Real Player si está instalada, para visualizarlo. Pero
antes, el virus liberará el archivo MELT.EXE, el cuál contiene el
caballo de Troya. El virus moverá luego su contenido al archivo
WINREG.EXE en la carpeta C:\WINDOWS, y borrará MELT.EXE.

WINREG.EXE funcionará entonces como una variante del servidor del
troyano SubSeven, quedando en segundo plano, a la espera que un
usuario que en forma remota, ejecutando el cliente, tome el control
de la computadora infectada.

- - - - ---
- - - - Trojan: Troj_Sub7.401315
- - - - Tipo: Caballo de Troya
- - - - Alias: Backdoor-G2.svr.gen, SUB7.401315
- - - - Tamaño: 401,315 bytes

Se trata de una variante del servidor del SubSeven. El troyano, se
instala a si mismo y modifica los archivos del sistema, para poder
ejecutarse en cada inicio de Windows. Una vez en memoria, y cuando la
víctima se conecta a Internet, envía una notificación a cualquier
usuario remoto que use la parte cliente de este troyano, a través del
ICQ y abre y se pone a la escucha por el puerto 1032 (puede ser
modificado), en espera de las ordenes del cliente.

El trojan se registra a si mismo como un servicio, de modo que se
ejecuta en segundo plano, sin ser visible en la lista de tareas
(CTRL+ALT+SUPR).

- - - - ---
- - - - Nombre: VBS/Aphex
- - - - Tipo: Gusano de mIRC y Visual Basic Script

Este virus escrito en Visual Basic Script, está contenido en un
archivo .HTM. Para que funcione, se requiere tener instalado el
Windows Scripting Host en nuestro PC.

Cuando un archivo .HTM infectado es abierto, un mensaje del Internet
Explorer advierte al usuario sobre la ejecución de código no seguro
(controles ActiveX).

Si el usuario pincha en SI, el virus procederá a realizará diferentes
acciones, como copiarse al sistema, borrar archivos con extensión .JS
o que comiencen con el nombre "jpg.*", archivos .HTM cuyos nombres
comiencen con "love", archivos .VBS cuyos nombres comiencen con
"clean", y cualquier archivo llamado "script.ini", "events.ini",
"movia.avi.pif", "win.com.bat", "mirc.bat", "tesk.sys", o
"mstesk.exe".

El gusano, intentará también enviarse a si mismo a los canales de
chat, modificando el archivo SCRIPT.INI usado por el cliente de IRC,
mIRC.

Puede encontrar más información sobre todos estos virus, y otros, así
como la forma de eliminarlos manualmente, en nuestro sitio:
http://www.videosoft.net.uy/

Más información sobre virus:
http://www.iec.csic.es/criptonomicon/articulos/virus.html

******************************************
Formación

******************************************
14 . Convocatoria de beca para tesis doctoral en Criptografía

SE OFRECE UNA BECA para la realización de la Tesis Doctoral en el
Grupo de Investigación en Matemática Aplicada a la Criptografía del
Departamento de Matemática Aplicada y Telemática de la Universitat
Politècnica de Catalunya. Los fondos para financiar esta beca
provienen de la subvención concedida por la Dirección General de
Investigación para el proyecto de investigación "Protocolos
criptográficos distribuidos y su aplicación a sistemas de
distribución y gestión de claves criptográficas y esquemas de firma
digital distribuida".

El becario deberá realizar las labores de investigación propias de la
elaboración de una Tesis Doctoral. La línea principal de su
investigación deberá ser el estudio de problemas relacionados con el
diseño de sistemas eficientes de firma digital colectiva. Estos
problemas están relacionados principalmente con varios protocolos
criptográficos que se utilizan como componentes de estos sistemas.

Buscamos un Titulado Superior, preferentemente Licenciado en
Matemáticas, interesado en temas relacionados con la Criptografía, la
Matemática Discreta y la Teoría de Números. Se valorará el dominio de
la lengua inglesa.

DURACIÓN DE LA BECA: Tres años.
RETRIBUCIÓN: 2.000.000 pta anuales.

Enviad vuestra solicitud, acompañada de un Curriculum Vitae, a la
dirección de correo electrónico matcpl@mat.upc.es, antes del 31 de
enero de 2001.
Si deseáis más información sobre esta beca, podéis contactar con
Carles Padró (la misma dirección).
Más información sobre el Grupo de Investigación en Matemática
Aplicada a la Criptografía, en la página
http://www-mat.upc.es/grup_de_cripto/

******************************************
Sobre el boletín del Criptonomicón

******************************************
15. Información sobre suscripción y cómo borrarse

Para borrarse de este servicio basta con enviar un correo a la
dirección cripto-request@iec.csic.es con el siguiente mensaje (sin
asunto o "subject"):

leave

desde la misma cuenta de correo en la que recibís el boletín.

Tenéis más información y números atrasados en la página

http://www.iec.csic.es/criptonomicon/suscripcion.html

******************************************
16. Números atrasados

Podéis encontrar los números atrasados del boletín en:

http://www.iec.csic.es/criptonomicon/suscripcion.html

Se pueden recuperar todos en formato ZIP o de uno en uno.

******************************************
17. Firma PGP

Se puede obtener la clave pública PGP del Criptonomicón en:

http://www.iec.csic.es/criptonomicon/criptonomicon.txt

Para más información sobre qué es el correo seguro y cómo funciona
PGP, se puede visitar:

http://www.iec.csic.es/criptonomicon/correo/

******************************************
(C) Copyright 2001 Criptonomicón
http://www.iec.csic.es/criptonomicon

Un servicio ofrecido libremente desde el Instituto de Física Aplicada
del CSIC por Gonzalo Álvarez Marañón
email: criptonomicon@iec.csic.es

Todos los trabajos, artículos, comentarios u opiniones de los
colaboradores de Criptonomicón son de su exclusiva responsabilidad,
siendo ellos los que responden de la veracidad y exactitud de sus
aportaciones. Criptonomicón agradece las mencionadas colaboraciones,
pero no comparte necesariamente las opiniones manifestadas. Asimismo,
es responsabilidad del lector descargar, instalar y ejecutar en su
propio sistema los programas que se mencionen en el Criptonomicón.

-----BEGIN PGP SIGNATURE-----
Version: PGPfreeware 6.5.8 for non-commercial use <http://www.pgp.com>

iQA/AwUBOmheKYUNKyrTCJjtEQKl2QCg58hOlb0A6clcFViZntcO6ypmH3oAoJoW
Gvy1BoZbEFLqy4ehWK5N4IyE
=SNRC
-----END PGP SIGNATURE-----



